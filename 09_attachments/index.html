
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Despliegue de plataforma para desarrollo, entrenamiento e implementación de modelos de machine learning en cloud computing">
      
      
        <meta name="author" content="Aguilera Conti Agustín">
      
      
      
        <link rel="prev" href="../08_bibliography/">
      
      
      
      <link rel="icon" href="../img/mlops_icon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.2">
    
    
      
        <title>Anexo - PPS - Agustin Aguilera Conti</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#anexo" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="PPS - Agustin Aguilera Conti" class="md-header__button md-logo" aria-label="PPS - Agustin Aguilera Conti" data-md-component="logo">
      
  <img src="../img/mlops_icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PPS - Agustin Aguilera Conti
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Anexo
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="lime"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aagustinconti/pps-kubeflow" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    aagustinconti/pps-kubeflow
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Introducción

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../02_workplan/" class="md-tabs__link">
        
  
    
  
  Plan de trabajo

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../03_cover_page/" class="md-tabs__link">
        
  
    
  
  Carátula

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../04_abstract/" class="md-tabs__link">
        
  
    
  
  Resumen

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../05_index/" class="md-tabs__link">
        
  
    
  
  Indice de contenidos

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../06_body/" class="md-tabs__link">
        
  
    
  
  Desarrollo

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../07_conclusion/" class="md-tabs__link">
        
  
    
  
  Conclusión

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../08_bibliography/" class="md-tabs__link">
        
  
    
  
  Bibliografía

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Anexo

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PPS - Agustin Aguilera Conti" class="md-nav__button md-logo" aria-label="PPS - Agustin Aguilera Conti" data-md-component="logo">
      
  <img src="../img/mlops_icon.png" alt="logo">

    </a>
    PPS - Agustin Aguilera Conti
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aagustinconti/pps-kubeflow" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    aagustinconti/pps-kubeflow
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_workplan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plan de trabajo
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_cover_page/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Carátula
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_abstract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resumen
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indice de contenidos
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_body/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desarrollo
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_conclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conclusión
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_bibliography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bibliografía
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Anexo
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Anexo
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metodologias-agiles" class="md-nav__link">
    <span class="md-ellipsis">
      Metodologías ágiles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metodologías ágiles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manifiesto-agil" class="md-nav__link">
    <span class="md-ellipsis">
      Manifiesto ágil
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manifiesto ágil">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#valores-del-manifiesto-agil" class="md-nav__link">
    <span class="md-ellipsis">
      Valores del Manifiesto Ágil
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#principios-del-manifiesto-agil" class="md-nav__link">
    <span class="md-ellipsis">
      Principios del Manifiesto Ágil
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scrum-roles-y-responsabilidades" class="md-nav__link">
    <span class="md-ellipsis">
      Scrum: Roles y responsabilidades
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cultura-devops" class="md-nav__link">
    <span class="md-ellipsis">
      Cultura DevOps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cultura DevOps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principios-y-valores-de-la-cultura-devops" class="md-nav__link">
    <span class="md-ellipsis">
      Principios y Valores de la Cultura DevOps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#como-se-utiliza-hoy-en-dia" class="md-nav__link">
    <span class="md-ellipsis">
      Cómo se utiliza hoy en día
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objetivos-smart" class="md-nav__link">
    <span class="md-ellipsis">
      Objetivos SMART
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-modo-de-sintesis" class="md-nav__link">
    <span class="md-ellipsis">
      A modo de síntesis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GitHub">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#semantic-releases" class="md-nav__link">
    <span class="md-ellipsis">
      Semantic Releases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Semantic Releases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#que-es-una-release" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Qué es una ‘release’?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#que-es-el-semantic-versioning" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Qué es el ‘semantic versioning’?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#que-estructura-tiene-la-semantic-versioning" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Qué estructura tiene la semantic versioning?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#premisas-del-semantic-versioning" class="md-nav__link">
    <span class="md-ellipsis">
      Premisas del semantic versioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-tagging-que-es-un-tag" class="md-nav__link">
    <span class="md-ellipsis">
      Git Tagging ¿Qué es un Tag?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semantic-versioning-annotated-tags-semantic-releases" class="md-nav__link">
    <span class="md-ellipsis">
      Semantic versioning + Annotated Tags = Semantic Releases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#por-que-plataformas-o-herramientas-esta-soportado-esto" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Por qué plataformas o herramientas está soportado esto?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#como-creo-las-semantic-git-releases" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Cómo creo las 'Semantic Git Releases'?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#release-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Release Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#como-automatizo-la-generacion-de-los-tags" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Cómo automatizo la generación de los tags?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Git Workflow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Git Workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Git Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-flow" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitlab-flow" class="md-nav__link">
    <span class="md-ellipsis">
      GitLab Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cual-elegimos" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Cual elegimos?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vagrant" class="md-nav__link">
    <span class="md-ellipsis">
      Vagrant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vagrant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-de-una-vagrantfile" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo de una Vagrantfile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download href="09_attachments.pdf" title="PDF Export"><svg style="height: 1.2rem; width: 1.2rem;" viewBox="0 0 384 512" xmlns="http://www.w3.org/2000/svg"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg></a>
                
                  

  
  


<h1 id="anexo">Anexo</h1>
<h2 id="metodologias-agiles">Metodologías ágiles</h2>
<h3 id="manifiesto-agil">Manifiesto ágil</h3>
<p>El Manifiesto Ágil es un documento que establece los valores y principios fundamentales para el desarrollo ágil de software. Fue creado en 2001 por un grupo de expertos en desarrollo de software que buscaban alternativas más flexibles y eficientes a los enfoques tradicionales de gestión de proyectos.</p>
<h4 id="valores-del-manifiesto-agil">Valores del Manifiesto Ágil</h4>
<ol>
<li><strong>Individuos e interacciones sobre procesos y herramientas:</strong> Se enfoca en la importancia de las personas y la comunicación efectiva en el desarrollo de software.</li>
<li><strong>Software funcionando sobre documentación extensiva:</strong> Prioriza la entrega de software funcional y utilizable por encima de una documentación exhaustiva.</li>
<li><strong>Colaboración con el cliente sobre negociación contractual:</strong> Destaca la importancia de la colaboración continua con el cliente para adaptarse a los cambios y requisitos emergentes.</li>
<li><strong>Responder a cambios sobre seguir un plan:</strong> Aboga por la flexibilidad y la capacidad de adaptarse a cambios en los requisitos, incluso en etapas avanzadas del desarrollo.</li>
</ol>
<h4 id="principios-del-manifiesto-agil">Principios del Manifiesto Ágil</h4>
<ol>
<li>La más alta prioridad es satisfacer al cliente mediante la entrega temprana y continua de software valioso.</li>
<li>Aceptar cambios en los requisitos, incluso en etapas tardías del desarrollo.</li>
<li>Entregar software funcional con frecuencia, con preferencia a intervalos cortos.</li>
<li>Colaborar con clientes y usuarios a lo largo del proyecto.</li>
<li>Construir proyectos alrededor de individuos motivados, dándoles el entorno y el apoyo que necesitan y confiando en ellos para que hagan el trabajo.</li>
<li>El método más eficiente y efectivo de comunicación es la conversación cara a cara.</li>
<li>El software funcional es la principal medida de progreso.**</li>
<li>Mantenerte enfocado en la simplicidad, maximizando la cantidad de trabajo no realizado.</li>
<li>Las mejores arquitecturas, requisitos y diseños surgen de equipos autoorganizados.</li>
<li>A intervalos regulares, el equipo reflexiona sobre cómo ser más efectivo y ajusta su comportamiento en consecuencia.</li>
</ol>
<p>Hoy en día, el Manifiesto Ágil sigue siendo un marco de referencia influyente para el desarrollo de software. Las metodologías ágiles como Scrum, Kanban y XP (eXtreme Programming) se basan en estos valores y principios. Las organizaciones adoptan enfoques ágiles para mejorar la flexibilidad, la capacidad de respuesta a cambios y la entrega continua de software de alta calidad. Además, la cultura ágil ha trascendido el ámbito del desarrollo de software y se ha extendido a otras áreas como la gestión de proyectos, el marketing y la gestión empresarial.</p>
<h3 id="scrum-roles-y-responsabilidades">Scrum: Roles y responsabilidades</h3>
<p>Scrum es un marco de trabajo ágil que se utiliza comúnmente en el desarrollo de software para gestionar proyectos de manera iterativa e incremental. Los roles en Scrum son esenciales para la colaboración y la entrega efectiva de productos. Los roles principales en Scrum y sus responsabilidades son:</p>
<ol>
<li><strong>Product Owner (Dueño del Producto):</strong><ul>
<li><em>Responsabilidades:</em><ul>
<li>Define la visión del producto.</li>
<li>Prioriza el backlog del producto.</li>
<li>Asegura que el equipo esté trabajando en las características más valiosas y prioritarias.</li>
<li>Toma decisiones sobre el alcance y las características del producto.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Scrum Master (Facilitador del Proceso):</strong><ul>
<li><em>Responsabilidades:</em><ul>
<li>Garantiza que el equipo Scrum siga las prácticas y reglas de Scrum.</li>
<li>Facilita las reuniones del equipo, como las reuniones de planificación, revisión y retrospectiva.</li>
<li>Elimina los obstáculos que impiden el progreso del equipo.</li>
<li>Ayuda a mantener un entorno de trabajo colaborativo y centrado en la entrega de valor.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Equipo de Desarrollo:</strong><ul>
<li><em>Responsabilidades:</em><ul>
<li>Desarrolla el producto durante los sprints.</li>
<li>Colabora en la planificación del sprint y define las tareas necesarias.</li>
<li>Se autoorganiza para lograr los objetivos del sprint.</li>
<li>Participa en las ceremonias de Scrum, como las reuniones diarias de scrum, la revisión y la retrospectiva.</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>Es importante destacar que en Scrum, se fomenta la colaboración y la autogestión del equipo. El Product Owner y el Scrum Master sirven al equipo y trabajan en conjunto para asegurar que el producto se desarrolle de manera efectiva y que se cumplan los objetivos del negocio. Además, Scrum promueve la transparencia, la inspección y la adaptación continua, lo que permite a los equipos responder rápidamente a los cambios en los requisitos o en el entorno del proyecto.</p>
<p>En Scrum, tanto el "Backlog" como el "Sprint" son conceptos fundamentales que contribuyen al enfoque iterativo e incremental del desarrollo de software.</p>
<ol>
<li>
<p><strong>Backlog:</strong></p>
<p>El "Product Backlog" (Backlog del Producto) es una lista dinámica y priorizada de todas las funcionalidades, mejoras y tareas que podrían ser realizadas para un producto. Es responsabilidad del Product Owner mantener y gestionar este backlog. Algunas características del Product Backlog incluyen:</p>
<ul>
<li><strong>Priorización:</strong> Las ítems del backlog están ordenados por prioridad, con las características más importantes o de mayor valor para el cliente en la parte superior.</li>
<li><strong>Flexibilidad:</strong> El backlog es flexible y puede cambiar con el tiempo para adaptarse a las necesidades cambiantes del negocio o del cliente.</li>
<li><strong>Detalles:</strong> Los elementos del backlog no necesitan estar detallados en exceso. Los detalles se refinan a medida que los elementos se acercan al tope del backlog y se preparan para ser incluidos en un sprint.</li>
<li><strong>Sprint:</strong></li>
</ul>
<p>Un "Sprint" es una unidad de tiempo fija y corta durante la cual se realiza un trabajo específico y se produce una versión potencialmente entregable del producto. Los sprints en Scrum generalmente tienen una duración de dos a cuatro semanas. Algunas características clave del Sprint incluyen:</p>
<ul>
<li><strong>Objetivo del Sprint:</strong> Antes de comenzar un Sprint, el equipo selecciona elementos del Product Backlog para incluir en el Sprint Backlog, que es la lista de elementos que se comprometen a completar durante el sprint.</li>
<li><strong>Iterativo e Incremental:</strong> El trabajo se realiza en ciclos iterativos, y al final de cada Sprint, se produce un incremento potencialmente entregable del producto.</li>
<li><strong>Reuniones:</strong> Durante el sprint, el equipo se reúne diariamente en la "Daily Scrum" para revisar el progreso y planificar el trabajo del día.</li>
<li><strong>Revisión y Retrospectiva:</strong> Al final del Sprint, se llevan a cabo la "Sprint Review" para presentar el trabajo completado y obtener retroalimentación, y la "Sprint Retrospective" para analizar el proceso y mejorar en futuros sprints.</li>
</ul>
</li>
</ol>
<p>La combinación del Backlog y los Sprints permite a los equipos Scrum mantener un enfoque ágil y responder rápidamente a los cambios en los requisitos del cliente o del negocio, al tiempo que entrega de manera regular incrementos de valor al producto.</p>
<p>Para nuestro caso, el tutor docente actuaría como Scrum Master, el tutor externo actuaría de Product Owner y el equipo de desarrollo estaría conformado por el alumno. Además hemos definido los <strong>sprints de una semana</strong>, y tomaremos tareas del backlog que se ha conformado a partir del plan de trabajo de esta PPS.</p>
<h3 id="cultura-devops">Cultura DevOps</h3>
<p>La cultura DevOps es una filosofía y práctica que promueve la colaboración estrecha y continua entre los equipos de desarrollo (Dev) y operaciones (Ops) en el ciclo de vida del desarrollo de software. El objetivo principal es superar las barreras tradicionales entre estos dos departamentos para lograr una entrega de software más rápida, eficiente y confiable.</p>
<h4 id="principios-y-valores-de-la-cultura-devops">Principios y Valores de la Cultura DevOps</h4>
<ol>
<li><strong>Colaboración y Comunicación:</strong><ul>
<li><em>Principio:</em> Fomentar la colaboración abierta y una comunicación efectiva entre los equipos de desarrollo y operaciones.</li>
</ul>
</li>
<li><strong>Automatización:</strong><ul>
<li><em>Principio:</em> Automatizar tanto como sea posible los procesos de desarrollo, prueba y despliegue para mejorar la eficiencia y reducir errores.</li>
</ul>
</li>
<li><strong>Entrega Continua:</strong><ul>
<li><em>Principio:</em> Buscar la entrega continua de software, permitiendo versiones pequeñas y frecuentes en lugar de despliegues masivos y menos frecuentes.</li>
</ul>
</li>
<li><strong>Monitoreo y Retroalimentación:</strong><ul>
<li><em>Principio:</em> Implementar sistemas de monitoreo para obtener retroalimentación rápida sobre el rendimiento y la calidad del software en producción.</li>
</ul>
</li>
<li><strong>Responsabilidad Compartida:</strong><ul>
<li><em>Principio:</em> Fomentar una mentalidad de responsabilidad compartida entre los equipos de desarrollo y operaciones en todo el ciclo de vida del software.</li>
</ul>
</li>
</ol>
<h4 id="como-se-utiliza-hoy-en-dia">Cómo se utiliza hoy en día</h4>
<p>La cultura DevOps se implementa mediante la adopción de prácticas y herramientas específicas, como:</p>
<ul>
<li><strong>Despliegue Continuo (Continuous Deployment):</strong> Automatización del proceso de liberación de software para que nuevas versiones puedan ser implementadas de manera rápida y segura.</li>
<li><strong>Infraestructura como Código (Infrastructure as Code - IaC):</strong> Definir y gestionar la infraestructura de manera automatizada, tratándola como código, lo que facilita la reproducibilidad y escalabilidad.</li>
<li><strong>Integración Continua (Continuous Integration):</strong> Integrar el código de los desarrolladores en un repositorio compartido varias veces al día, lo que facilita la detección temprana de errores.</li>
<li><strong>Monitoreo Continuo y Análisis de Logs:</strong> Utilizar herramientas para monitorear el rendimiento en tiempo real y analizar los registros para identificar problemas y áreas de mejora.</li>
</ul>
<p>A modo de síntesis, la cultura DevOps busca mejorar la colaboración, eficiencia y velocidad en el desarrollo y despliegue de software, y se apoya en la automatización, la entrega continua y la responsabilidad compartida entre los equipos de desarrollo y operaciones.</p>
<h3 id="objetivos-smart">Objetivos SMART</h3>
<p>Los objetivos SMART son una metodología utilizada para establecer metas y objetivos de manera clara y específica. El acrónimo SMART representa los criterios que deben cumplir estos objetivos:</p>
<ol>
<li><strong>Específicos (Specific):</strong> Los objetivos deben ser claros y específicos, evitando ambigüedades y definiciones vagas.</li>
<li><strong>Medibles (Measurable):</strong> Deben incluir criterios cuantificables para evaluar el progreso y determinar cuándo se ha alcanzado el objetivo.</li>
<li><strong>Alcanzables (Achievable):</strong> Los objetivos deben ser realistas y alcanzables dentro del contexto y recursos disponibles.</li>
<li><strong>Relevantes (Relevant):</strong> Deben estar alineados con los objetivos generales y estratégicos de la organización.</li>
<li><strong>Temporizables (Time-bound):</strong> Deben tener un plazo o período de tiempo específico para su cumplimiento.</li>
</ol>
<p>Relacionando los objetivos SMART con Scrum en el contexto de Backlog, Sprint o Tarea:</p>
<ul>
<li><strong>Backlog:</strong> Los elementos del Product Backlog en Scrum se benefician al ser definidos de manera SMART. Cada elemento debe ser específico en cuanto a su funcionalidad, medible en términos de valor para el usuario, alcanzable dentro del alcance del proyecto, relevante para los objetivos del producto y con un plazo temporal definido.</li>
<li><strong>Sprint:</strong> Los objetivos de cada Sprint, establecidos durante la planificación del Sprint, también pueden seguir la metodología SMART. Al ser específicos, medibles, alcanzables, relevantes y temporizables, estos objetivos guiarán el trabajo del equipo durante el Sprint.</li>
<li><strong>Tarea:</strong> Incluso a nivel de tareas individuales dentro de un Sprint, la aplicación de la metodología SMART puede ser útil. Cada tarea puede ser definida de manera específica, medible en términos de esfuerzo o resultados, alcanzable para un miembro del equipo, relevante para los objetivos del Sprint y con un plazo temporal asignado.</li>
</ul>
<p>La aplicación de objetivos SMART en Scrum contribuye a una mayor claridad, enfoque y medición del progreso en el desarrollo de software, alineando los esfuerzos del equipo con metas claras y alcanzables.</p>
<h3 id="a-modo-de-sintesis">A modo de síntesis</h3>
<p>Las metodologías ágiles, encabezadas por el Manifiesto Ágil, han transformado la forma en que se aborda el desarrollo de software al promover valores como la flexibilidad, la colaboración y la entrega continua de valor al cliente. SCRUM, una de las metodologías ágiles más populares, opera bajo los principios del Manifiesto Ágil y estructura el desarrollo en sprints, con roles claramente definidos y un enfoque en la transparencia y adaptabilidad. La cultura DevOps, por otro lado, se alinea con los principios ágiles al fomentar la colaboración estrecha entre los equipos de desarrollo y operaciones, buscando la automatización y la entrega continua. En este contexto, los objetivos SMART se integran como una metodología clave para establecer metas claras, medibles y alcanzables, proporcionando un marco estructurado que puede aplicarse tanto a la gestión del backlog en SCRUM como a los objetivos específicos de cada sprint. La combinación de metodologías ágiles, SCRUM, la cultura DevOps y objetivos SMART crea un entorno de desarrollo flexible, colaborativo y orientado a resultados, permitiendo a los equipos adaptarse rápidamente a los cambios, mejorar continuamente y cumplir con los objetivos estratégicos de la organización.</p>
<h2 id="github">GitHub</h2>
<h3 id="semantic-releases">Semantic Releases</h3>
<h4 id="que-es-una-release">¿Qué es una ‘release’?</h4>
<p>Una release es empaquetar cualquier cambio en el código y enviarlo a producción. Por ejemplo, un cambio de nuestra página web que vaya al público y no a nuestra etapa de desarrollo.</p>
<p>El manejo de estas releases puede ser un poco complicado, especialmente si no seguimos un cierto standard. Por eso es que usamos ‘semantic versioning’ con git tags para manejar de manera fácil nuestras releases.</p>
<h4 id="que-es-el-semantic-versioning">¿Qué es el ‘semantic versioning’?</h4>
<p>El semantic versioning es sólo un esqueman numérico, es una práctica estándar de la industria del software que sirve para indicar el “grado de cambios” que se han hecho desde la release de producción anterior. Todos usan semantic versioning, desde Git, hasta Firefox y los SO como iOS.</p>
<h4 id="que-estructura-tiene-la-semantic-versioning">¿Qué estructura tiene la semantic versioning?</h4>
<p>Tiene 3 partes:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>MAJOR.MINOR.PATCH
</code></pre></div>
<p>Cada una de las partes indica algo diferente cuando incrementa:</p>
<ul>
<li>
<p><strong>Major:</strong> Cuando vamos de 1.0.0 a 2.0.0 indicamos que cambiamos de manera disruptiva, incluimos cambios que no sean compatibles hacia atrás, etc. Por ejemplo, remover código que ya no sirve para incluir una reestructuración completa de la arquitectura de nuestra aplicación.</p>
</li>
<li>
<p><strong>Minor:</strong> Cuando vamos de 1.0.1 a 1.1.0 indicamos que cambiamos funcionalidades, pero que estos cambios son compatibles hacia atrás. Puede ser el cambio de una funcionalidad, la actualización de una, el agregado de otra.</p>
</li>
<li>
<p><strong>Patch:</strong>  Cuando vamos de 1.0.1 a 1.0.2 indicamos arreglos de bugs y actualizaciones triviales.</p>
</li>
</ul>
<h4 id="premisas-del-semantic-versioning">Premisas del semantic versioning</h4>
<ul>
<li>Una vez hecha una release, la versión no puede ser cambiada</li>
<li>Si nos olvidamos algo no podemos “retaggear” una versión, estos deberían entrar en una nueva release.</li>
<li>Somos responsables de checkear reiteradamente la versión actual antes de hacer un release.</li>
</ul>
<h4 id="git-tagging-que-es-un-tag">Git Tagging ¿Qué es un Tag?</h4>
<p>Es una manera de agregar un marcador o marker a un commit para indicar que es importante de alguna manera en nuestro repositorio. Hay dos diferentes tipos de GitTags:</p>
<ul>
<li>
<p><strong>Lightweigh tags:</strong> Un puntero con nombre básico para un commit.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>&gt;<span class="w"> </span>git<span class="w"> </span>tag<span class="w"> </span>&lt;tag-name&gt;<span class="w"> </span><span class="o">[</span>commit<span class="o">]</span>
</code></pre></div>
</li>
<li>
<p><strong>Annotated tags:</strong> Un objeto completo en la database de git verificado, contiene información de el tag, tiene un mensaje de taggeo (tagging message) y puede ser firmada y verificada con GNU Privacy Guard (GPG). Esta última es la que se recomienda usar.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>&gt;<span class="w"> </span>git<span class="w"> </span>tag<span class="w"> </span>-a<span class="w"> </span>&lt;tag-name&gt;<span class="w"> </span>-m<span class="s2">&quot;&lt;annotation&gt;&quot;</span><span class="w"> </span><span class="o">[</span>commit<span class="o">]</span>
</code></pre></div>
</li>
</ul>
<p>Tanto el semantic versioning como el GitTagging van de la mano, podemos agregar un commit taggeando la versión correspondiente.</p>
<h4 id="semantic-versioning-annotated-tags-semantic-releases">Semantic versioning + Annotated Tags = Semantic Releases</h4>
<p>Nos permite tener commits marcados en nuestro repositorio de git con una versión específica. Los beneficios de esto en un repositorio de git son:</p>
<ul>
<li>Le da significado a los cambios importantes en nuestro repositorio.</li>
<li>Comunica el “grado de cambio” entre los diferentes tags.</li>
<li>Vemos de manera directa el historial de tracking de los cambios realizados.</li>
</ul>
<h4 id="por-que-plataformas-o-herramientas-esta-soportado-esto">¿Por qué plataformas o herramientas está soportado esto?</h4>
<ul>
<li>Diferentes interfaces de Git, como Git Kraken o GitHub Desktop.</li>
<li>Diferentes herramientas de automatización como Circle CI, Bitbucket, Travis, etc.</li>
</ul>
<h4 id="como-creo-las-semantic-git-releases">¿Cómo creo las 'Semantic Git Releases'?</h4>
<p>Es un proceso que consiste en 3 pasos:</p>
<ol>
<li>Crear un annotated tag<ol>
<li>Usar semantic versioning para el nombre del tag</li>
<li>Brindar una annotation</li>
</ol>
</li>
<li>Pushear el tag al repositorio remoto</li>
<li>Insertar los pasos de deployment acá</li>
</ol>
<p>Crear una un semantic release tag usando la consola:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>&gt;<span class="w"> </span>git<span class="w"> </span>tag<span class="w"> </span>-a<span class="w"> </span>v1.0.0<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;release 1.0.0&quot;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>&gt;<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>&lt;remote&gt;<span class="w"> </span>v1.0.0
</code></pre></div>
<h4 id="release-notes">Release Notes</h4>
<p>Tenemos que evitar las anotaciones mínimas. Se recomienda, para cada tipo de release:</p>
<ul>
<li><strong>Patch:</strong> Lista de los bug fixes</li>
<li><strong>Minor:</strong> Lista de cambios, detalles de uso.</li>
<li><strong>Major:</strong> Lista de elementos removidos, lista de cosas agregadas, proceso de actualización.</li>
</ul>
<p><strong>Tomar una lista de los mensajes de los commits entre releases:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>git<span class="w"> </span>log<span class="w"> </span>--pretty<span class="o">=</span>format:%s<span class="w"> </span>&lt;last<span class="w"> </span>release&gt;...<span class="w"> </span>HEAD<span class="w"> </span>--no-merges
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>git<span class="w"> </span>tag<span class="w"> </span>-a<span class="w"> </span>&lt;tag-name&gt;<span class="w"> </span>-m<span class="s2">&quot;</span><span class="k">$(</span>git<span class="w"> </span>log<span class="w"> </span>--pretty<span class="o">=</span>format:%s<span class="w"> </span>&lt;last<span class="w"> </span>release&gt;...<span class="w"> </span>HEAD<span class="w"> </span>--no-merges<span class="k">)</span><span class="s2">&quot;</span>
</code></pre></div>
<h4 id="como-automatizo-la-generacion-de-los-tags">¿Cómo automatizo la generación de los tags?</h4>
<ul>
<li>Puedo buscar en el mercado por alguna herramienta de automatización.</li>
<li>Crear un script de bash por nosotros mismos para ayudarnos a automatizar los pasos repetitivos.</li>
</ul>
<h3 id="git-workflow">Git Workflow</h3>
<p>Los Git Workflows son metodologías de trabajo para los usuarios de de Git.  </p>
<h4 id="git-flow">Git Flow</h4>
<p>Es el workflow más conocido, basado en dos branches principales que son perpetuas, con vida infinita. Estas son:</p>
<ul>
<li><strong>master:</strong> Tiene el código de producción. Todo el código de desarrollo es ‘mergeado’ dentro de la branch master en algún momento.</li>
<li><strong>develop:</strong>  Contiene el código de pre-producción. Cuando las modificacioens o nuevas características estén finalizadas, se ‘mergean’ en la branch develop.</li>
</ul>
<p>Durante el ciclo de desarrollo, una variedad de ramas de soporte son utilizadas:</p>
<ul>
<li><strong>feature-*:</strong> Usada para desarrollar nuevas caracterísitcas que vendrán en las futuras releases. Debería desprenderse de la rama develop y mergearse en la rama develop.</li>
<li><strong><em>hotfix-</em>:</strong> Son necesarias para actuar inmediatamente ante un estado indeseado de la branch master. Debería desprenderse de la branch master y mergearse tanto en máster como en develop.</li>
<li><strong>release-*:</strong> Son la preparación de una nueva release de producción. Permiten que haya menos bugs que arreglar y la preparación de la metadata para la release. Debe desprenderse de la rama develop y debe ser mergeada en la rama master y develop.</li>
</ul>
<h4 id="github-flow">GitHub Flow</h4>
<p>Es un workflow liviano creado por GitHub y se basa en 6 principios:</p>
<ol>
<li>Todo en la rama <strong>master</strong> es deployable.</li>
<li>Para trabajar en algo nuevo, creamos una rama desde la master con un nombre descriptivo.</li>
<li>Hacemos commit a esa rama localmente y regularmente hacemos push del trabajo a la misma rama en remoto.</li>
<li>Cuando necesitamos feedback o creemos que es necesario mergear, abrimos un Pull Request (PR).</li>
<li>Despues de que alguien haya revisado y firmado la nueva característica, se puede hacer merge en la master.</li>
<li>Una vez hecho el merge y pusheado a la rama master, debemos deployar inmediatamente.</li>
</ol>
<h4 id="gitlab-flow">GitLab Flow</h4>
<p>Es un workflow creado por GitLab. Combina un desarrollo dirigido por las funcionalidades (caracteristicas) y con ramas de funcionalidades con un trackeo de problemas.</p>
<p>La mayor diferencia con GitHub Flow es el ambiente de las ramas que tenemos en GitLab Flow (staging y production) porque será un proyecto que no puede deployarse en producción cada vez que hacemos un merge de una nueva feature branch. Se basa en 11 principios:</p>
<ol>
<li>Usa feature branches, no commits directos a master.</li>
<li>Prueba todos los commits, no solo los de la master.</li>
<li>Corre todos los test en todos los commits.</li>
<li>Hacer revisión de codigo antes de hacer el merge en master.</li>
<li>Los deployments son automáticos, basados en las branches o tags.</li>
<li>Los tags son configurados por el usuario, no por el CI.</li>
<li>Las releases son basadas en tags.</li>
<li>Los commits ya pusheados nunca son rebasados.</li>
<li>Todos comienzan por master y apuntan a master.</li>
<li>Corregir bugs en master primero, release branches segundo.</li>
<li>Los commits reflejan la intención.</li>
</ol>
<h4 id="cual-elegimos">¿Cual elegimos?</h4>
<p>Por simplicidad y por la plataforma en la que estamos trabajando el workflow más conveniente será <strong>GitHub Workflow</strong>.</p>
<h2 id="vagrant">Vagrant</h2>
<p>Vagrant es una herramienta que podés usar para crear y gestionar entornos de desarrollo virtualizados de manera fácil y reproducible. Su uso típico es facilitar la creación de máquinas virtuales con configuraciones específicas para el desarrollo de proyectos.</p>
<p>Para comenzar un proyecto de Vagrant en el directorio /vagrant, el usuario puede seguir estos pasos:</p>
<ol>
<li><strong>Instalación de Vagrant:</strong>
Antes que nada, necesitás instalar Vagrant en tu máquina. Esto se puede hacer descargando el instalador desde el sitio oficial y siguiendo las instrucciones.</li>
<li><strong>Creación de un archivo Vagrantfile:</strong>
En el directorio donde querés iniciar el proyecto, creá un archivo llamado <code>Vagrantfile</code>. Este archivo contendrá la configuración de la máquina virtual, como el sistema operativo, la cantidad de memoria RAM, etc.</li>
<li><strong>Configuración del Vagrantfile:</strong>
Dentro del Vagrantfile, especificá la configuración deseada. Por ejemplo, podés elegir un sistema operativo base, asignar recursos como CPU y RAM, y configurar la red.</li>
<li><strong>Inicialización de la máquina virtual:</strong>
Ejecutá el comando <code>vagrant up</code> en el directorio donde se encuentra el Vagrantfile. Este comando creará y provisionará la máquina virtual según la configuración especificada.</li>
<li><strong>Acceso a la máquina virtual:</strong>
Utilizá el comando <code>vagrant ssh</code> para acceder a la máquina virtual recién creada. Esto abrirá una conexión SSH a la máquina virtual.</li>
</ol>
<p>Algunas ventajas clave de utilizar Vagrant para levantar múltiples entornos de desarrollo son:</p>
<ul>
<li><strong>Reproducibilidad:</strong> Con Vagrant, se puede garantizar que todos los miembros del equipo tengan exactamente el mismo entorno de desarrollo, evitando problemas de compatibilidad.</li>
<li><strong>Portabilidad:</strong> Los entornos Vagrant son independientes de la máquina host, lo que significa que podés compartir el mismo entorno de desarrollo en diferentes sistemas operativos.</li>
<li><strong>Aislamiento:</strong> Cada proyecto puede tener su propio entorno virtualizado, evitando conflictos entre dependencias y facilitando la gestión de versiones de software.</li>
<li><strong>Eficiencia en el uso de recursos:</strong> Vagrant permite ejecutar varias máquinas virtuales de manera eficiente, lo que es útil para simular entornos complejos, como redes privadas virtuales (VPNs) o arquitecturas de microservicios.</li>
</ul>
<h3 id="ejemplo-de-una-vagrantfile">Ejemplo de una Vagrantfile</h3>
<p>Crearemos un entorno de 3 máquinas, una master y 2 nodos a los cuales les aplicaremos configuraciones generales y particulares a cad auno. Importante aclarar que usaremos una imagen distinta a la vista antes, en este caso será <code>ubuntu/trusty64</code>.</p>
<p><strong>¡Importante!</strong> Para poder configurar cierta red privada deberemos crear o modificar el archivo <code>/etc/vbox/networks.conf</code> añadiendo la red de la siguiente manera:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">sudo</span><span class="w"> </span><span class="n">su</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;* 0.0.0.0/0&quot;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">networks</span><span class="o">.</span><span class="n">conf</span>
</code></pre></div>
<p><strong>Primero vamos a crear las claves públicas y privadas para las conexiones SSH:</strong></p>
<p>Creamos nuestra propia clave pública y privada con <code>ssh-keygen</code>, procuramos no poner passphrase para que no se la solicite a las VMs a la hora de iniciarlas.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># ~/.ssh/</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>&gt;<span class="w"> </span>ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-b<span class="w"> </span><span class="m">4096</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>Generating<span class="w"> </span>public/private<span class="w"> </span>rsa<span class="w"> </span>key<span class="w"> </span>pair.
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>Enter<span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span>which<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>the<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>/home/aagustin/.ssh/id_rsa<span class="o">)</span>:<span class="w"> </span>vagrant_key
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>Enter<span class="w"> </span>passphrase<span class="w"> </span><span class="o">(</span>empty<span class="w"> </span><span class="k">for</span><span class="w"> </span>no<span class="w"> </span>passphrase<span class="o">)</span>:<span class="w"> </span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>Enter<span class="w"> </span>same<span class="w"> </span>passphrase<span class="w"> </span>again:<span class="w"> </span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>Your<span class="w"> </span>identification<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span>vagrant_key
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>Your<span class="w"> </span>public<span class="w"> </span>key<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span>vagrant_key.pub
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>The<span class="w"> </span>key<span class="w"> </span>fingerprint<span class="w"> </span>is:
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>SHA256:K4v2o7EKOLfjCMLk7zVD4v234234c06peueU<span class="w"> </span>aagustin@hp-agustin
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>The<span class="w"> </span>key<span class="err">&#39;</span>s<span class="w"> </span>randomart<span class="w"> </span>image<span class="w"> </span>is:
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>+---<span class="o">[</span>RSA<span class="w"> </span><span class="m">4096</span><span class="o">]</span>----+
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="p">|</span><span class="w">                 </span><span class="p">|</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="p">|</span><span class="w">                 </span><span class="p">|</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="p">|</span><span class="w">                 </span><span class="p">|</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="p">|</span><span class="w">                 </span><span class="p">|</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="p">|</span><span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.S<span class="w">     </span>.<span class="w">  </span><span class="p">|</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="p">|</span><span class="o">=</span><span class="w"> </span>.<span class="w"> </span><span class="m">3</span><span class="w"> </span>o<span class="w"> </span>..<span class="w">   </span>o..<span class="w"> </span><span class="p">|</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="p">|</span>*o.+.*....<span class="w"> </span>+.++.<span class="w"> </span><span class="p">|</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="p">|</span><span class="nv">o</span><span class="o">=</span>o.B4<span class="o">==</span><span class="w">  </span>.<span class="w"> </span>*++<span class="w">  </span><span class="p">|</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="p">|</span>..<span class="o">=</span>*+*<span class="o">=</span>++<span class="w"> </span>.+o.<span class="w"> </span>E<span class="w"> </span><span class="p">|</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</code></pre></div>
<p><strong>Ahora si, escribimos el archivo Vagrantfile:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># -*- mode: ruby -*-</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c1"># vi: set ft=ruby :</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># All Vagrant configuration is done below. The &quot;2&quot; in Vagrant.configure</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c1"># configures the configuration version (we support older styles for</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c1"># backwards compatibility). Please don&#39;t change it unless you know what</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c1"># you&#39;re doing.</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">config</span><span class="o">|</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">  </span><span class="c1"># Image configuration (for all vm&#39;s)</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bento/ubuntu-22.04&quot;</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;202309.08.0&quot;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">  </span><span class="c1"># SSH (for all vm&#39;s)</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">insert_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">false</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">forward_agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">true</span><span class="w">  </span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;/home/aagustin/.vagrant.d/insecure_private_key&quot;</span><span class="p">,</span><span class="s2">&quot;/home/aagustin/.ssh/vagrant_key&quot;</span><span class="o">]</span><span class="w">     </span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">source</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/home/aagustin/.ssh/vagrant_key.pub&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">destination</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/home/vagrant/.ssh/authorized_keys&quot;</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">  </span><span class="c1"># Declaring master node and defining it like a primary machine</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">define</span><span class="w"> </span><span class="s2">&quot;master&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">primary</span><span class="p">:</span><span class="w"> </span><span class="kp">true</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">master</span><span class="o">|</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w">    </span><span class="c1"># Resources (provider)</span>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="w">    </span><span class="n">master</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span><span class="w"> </span><span class="s2">&quot;virtualbox&quot;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">vb</span><span class="o">|</span>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="w">      </span><span class="n">vb</span><span class="o">.</span><span class="n">gui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">false</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="w">      </span><span class="n">vb</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;trusty64-master&quot;</span>
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="w">      </span><span class="n">vb</span><span class="o">.</span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;2048&quot;</span>
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="w">      </span><span class="n">vb</span><span class="o">.</span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>
<a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a><span class="w">    </span><span class="c1"># Configure synced folder</span>
<a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a><span class="w">    </span><span class="c1">#config.vm.synced_folder &quot;~/my-loc/vagrant/synced/folders/master/&quot;, &quot;/home/vagrant/&quot;</span>
<a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>
<a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a><span class="w">    </span><span class="c1"># Network configuration</span>
<a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a><span class="w">    </span><span class="n">master</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;public_network&quot;</span><span class="p">,</span>
<a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a><span class="w">      </span><span class="ss">bridge</span><span class="p">:</span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a><span class="w">      </span><span class="ss">ip</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.102.102&quot;</span><span class="p">,</span>
<a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a><span class="w">      </span><span class="ss">netmask</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;255.255.255.0&quot;</span>
<a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>
<a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a><span class="w">    </span><span class="n">master</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;private_network&quot;</span><span class="p">,</span>
<a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a><span class="w">      </span><span class="ss">ip</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.55.2&quot;</span><span class="p">,</span>
<a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a><span class="w">      </span><span class="ss">netmask</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;255.255.255.0&quot;</span><span class="p">,</span>
<a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a><span class="w">      </span><span class="ss">auto_config</span><span class="p">:</span><span class="w"> </span><span class="kp">false</span>
<a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>
<a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a><span class="w">    </span><span class="n">master</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span>
<a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a><span class="w">      </span><span class="ss">guest</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span>
<a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a><span class="w">      </span><span class="ss">host</span><span class="p">:</span><span class="w"> </span><span class="mi">31002</span>
<a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>
<a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a><span class="w">    </span><span class="c1"># SSH</span>
<a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a><span class="w">    </span><span class="n">master</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;127.0.0.2&quot;</span>
<a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a><span class="w">    </span><span class="n">master</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span>
<a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a><span class="w">      </span><span class="ss">guest</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span>
<a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a><span class="w">      </span><span class="ss">host</span><span class="p">:</span><span class="w"> </span><span class="mi">2222</span><span class="p">,</span>
<a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a><span class="w">      </span><span class="ss">host_ip</span><span class="p">:</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span>
<a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a><span class="w">      </span><span class="nb">id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ssh&quot;</span><span class="p">,</span>
<a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a><span class="w">      </span><span class="ss">auto_correct</span><span class="p">:</span><span class="w"> </span><span class="kp">true</span>
<a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a>
<a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a><span class="w">    </span><span class="c1"># Provisioning message</span>
<a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a><span class="w">    </span><span class="n">master</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span><span class="w"> </span><span class="s2">&quot;shell&quot;</span><span class="p">,</span>
<a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a><span class="w">      </span><span class="ss">inline</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;echo Hello master&quot;</span>
<a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a>
<a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a><span class="w">  </span><span class="c1"># Declaring secondary nodes (iteratively)</span>
<a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a><span class="w">  </span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">each</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">i</span><span class="o">|</span>
<a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a><span class="w">    </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">define</span><span class="w"> </span><span class="s2">&quot;node-</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">node</span><span class="o">|</span>
<a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a>
<a id="__codelineno-7-68" name="__codelineno-7-68" href="#__codelineno-7-68"></a><span class="w">      </span><span class="c1"># Resources (provider)</span>
<a id="__codelineno-7-69" name="__codelineno-7-69" href="#__codelineno-7-69"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span><span class="w"> </span><span class="s2">&quot;virtualbox&quot;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">vb</span><span class="o">|</span>
<a id="__codelineno-7-70" name="__codelineno-7-70" href="#__codelineno-7-70"></a><span class="w">        </span><span class="n">vb</span><span class="o">.</span><span class="n">gui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">false</span>
<a id="__codelineno-7-71" name="__codelineno-7-71" href="#__codelineno-7-71"></a><span class="w">        </span><span class="n">vb</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;trusty64-node-</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-7-72" name="__codelineno-7-72" href="#__codelineno-7-72"></a><span class="w">        </span><span class="n">vb</span><span class="o">.</span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;2048&quot;</span>
<a id="__codelineno-7-73" name="__codelineno-7-73" href="#__codelineno-7-73"></a><span class="w">        </span><span class="n">vb</span><span class="o">.</span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<a id="__codelineno-7-74" name="__codelineno-7-74" href="#__codelineno-7-74"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-7-75" name="__codelineno-7-75" href="#__codelineno-7-75"></a>
<a id="__codelineno-7-76" name="__codelineno-7-76" href="#__codelineno-7-76"></a><span class="w">      </span><span class="c1"># Configure synced folder</span>
<a id="__codelineno-7-77" name="__codelineno-7-77" href="#__codelineno-7-77"></a><span class="w">      </span><span class="c1">#config.vm.synced_folder &quot;~/my-loc/vagrant/synced/folders/node-#{i}/&quot;, &quot;/home/vagrant/&quot;</span>
<a id="__codelineno-7-78" name="__codelineno-7-78" href="#__codelineno-7-78"></a>
<a id="__codelineno-7-79" name="__codelineno-7-79" href="#__codelineno-7-79"></a><span class="w">      </span><span class="c1"># Network configuration</span>
<a id="__codelineno-7-80" name="__codelineno-7-80" href="#__codelineno-7-80"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;public_network&quot;</span><span class="p">,</span>
<a id="__codelineno-7-81" name="__codelineno-7-81" href="#__codelineno-7-81"></a><span class="w">        </span><span class="ss">bridge</span><span class="p">:</span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<a id="__codelineno-7-82" name="__codelineno-7-82" href="#__codelineno-7-82"></a><span class="w">        </span><span class="ss">ip</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.102.10</span><span class="si">#{</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-7-83" name="__codelineno-7-83" href="#__codelineno-7-83"></a><span class="w">        </span><span class="ss">netmask</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;255.255.255.0&quot;</span>
<a id="__codelineno-7-84" name="__codelineno-7-84" href="#__codelineno-7-84"></a>
<a id="__codelineno-7-85" name="__codelineno-7-85" href="#__codelineno-7-85"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;private_network&quot;</span><span class="p">,</span>
<a id="__codelineno-7-86" name="__codelineno-7-86" href="#__codelineno-7-86"></a><span class="w">        </span><span class="ss">ip</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.55.</span><span class="si">#{</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-7-87" name="__codelineno-7-87" href="#__codelineno-7-87"></a><span class="w">        </span><span class="ss">netmask</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;255.255.255.0&quot;</span><span class="p">,</span>
<a id="__codelineno-7-88" name="__codelineno-7-88" href="#__codelineno-7-88"></a><span class="w">        </span><span class="ss">auto_config</span><span class="p">:</span><span class="w"> </span><span class="kp">false</span>
<a id="__codelineno-7-89" name="__codelineno-7-89" href="#__codelineno-7-89"></a>
<a id="__codelineno-7-90" name="__codelineno-7-90" href="#__codelineno-7-90"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span>
<a id="__codelineno-7-91" name="__codelineno-7-91" href="#__codelineno-7-91"></a><span class="w">        </span><span class="ss">guest</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span>
<a id="__codelineno-7-92" name="__codelineno-7-92" href="#__codelineno-7-92"></a><span class="w">        </span><span class="ss">host</span><span class="p">:</span><span class="w"> </span><span class="mi">31002</span><span class="o">+</span><span class="n">i</span>
<a id="__codelineno-7-93" name="__codelineno-7-93" href="#__codelineno-7-93"></a>
<a id="__codelineno-7-94" name="__codelineno-7-94" href="#__codelineno-7-94"></a><span class="w">      </span><span class="c1"># SSH</span>
<a id="__codelineno-7-95" name="__codelineno-7-95" href="#__codelineno-7-95"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;127.0.0.</span><span class="si">#{</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-7-96" name="__codelineno-7-96" href="#__codelineno-7-96"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span>
<a id="__codelineno-7-97" name="__codelineno-7-97" href="#__codelineno-7-97"></a><span class="w">        </span><span class="ss">guest</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span>
<a id="__codelineno-7-98" name="__codelineno-7-98" href="#__codelineno-7-98"></a><span class="w">        </span><span class="ss">host</span><span class="p">:</span><span class="w"> </span><span class="mi">2222</span><span class="o">+</span><span class="n">i</span><span class="p">,</span>
<a id="__codelineno-7-99" name="__codelineno-7-99" href="#__codelineno-7-99"></a><span class="w">        </span><span class="ss">host_ip</span><span class="p">:</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span>
<a id="__codelineno-7-100" name="__codelineno-7-100" href="#__codelineno-7-100"></a><span class="w">        </span><span class="nb">id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ssh&quot;</span><span class="p">,</span>
<a id="__codelineno-7-101" name="__codelineno-7-101" href="#__codelineno-7-101"></a><span class="w">        </span><span class="ss">auto_correct</span><span class="p">:</span><span class="w"> </span><span class="kp">true</span>
<a id="__codelineno-7-102" name="__codelineno-7-102" href="#__codelineno-7-102"></a>
<a id="__codelineno-7-103" name="__codelineno-7-103" href="#__codelineno-7-103"></a><span class="w">      </span><span class="c1"># Provisioning message</span>
<a id="__codelineno-7-104" name="__codelineno-7-104" href="#__codelineno-7-104"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span><span class="w"> </span><span class="s2">&quot;shell&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">inline</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;echo Hello node-</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-7-105" name="__codelineno-7-105" href="#__codelineno-7-105"></a><span class="w">    </span><span class="k">end</span><span class="w">      </span>
<a id="__codelineno-7-106" name="__codelineno-7-106" href="#__codelineno-7-106"></a>
<a id="__codelineno-7-107" name="__codelineno-7-107" href="#__codelineno-7-107"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-7-108" name="__codelineno-7-108" href="#__codelineno-7-108"></a>
<a id="__codelineno-7-109" name="__codelineno-7-109" href="#__codelineno-7-109"></a><span class="k">end</span>
</code></pre></div>
<p>Notar que en la línea <code>config.ssh.private_key_path = ["/home/aagustin/.vagrant.d/insecure_private_key","/home/aagustin/.ssh/vagrant_key"]</code> ponemos dos opciones, lo que logramos con esto es que use primero la por default y luego de lograda la conexión ya configura la clave pública, entonces podemos acceder con la clave propia la próxima vez. Además es importante que esté desactivada la generación por defecto de nuevas claves así se usa la genérica, por eso tenemo la línea <code>config.ssh.insert_key = false</code>.</p>
<p><strong>Levantamos nuestra configuración:</strong></p>
<p>Podemos hacer <code>vagrant up</code> y por ultimo veremos el estado de estas con:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>$<span class="w"> </span>vagrant<span class="w"> </span>status
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Current<span class="w"> </span>machine<span class="w"> </span>states:
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>master<span class="w">                    </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>node-1<span class="w">                    </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>node-2<span class="w">                    </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>This<span class="w"> </span>environment<span class="w"> </span>represents<span class="w"> </span>multiple<span class="w"> </span>VMs.<span class="w"> </span>The<span class="w"> </span>VMs<span class="w"> </span>are<span class="w"> </span>all<span class="w"> </span>listed
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>above<span class="w"> </span>with<span class="w"> </span>their<span class="w"> </span>current<span class="w"> </span>state.<span class="w"> </span>For<span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>specific
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>VM,<span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>vagrant<span class="w"> </span>status<span class="w"> </span>NAME<span class="sb">`</span>.
</code></pre></div>
<p><strong>Nos conectamos con las VPCs:</strong></p>
<p>Podemos acceder con SSH mediante:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>ssh<span class="w"> </span>-p<span class="w"> </span><span class="o">[</span>puerto-vpc<span class="o">]</span><span class="w"> </span>vagrant@<span class="o">[</span>ip-vpc<span class="o">]</span><span class="w"> </span>-i<span class="w"> </span><span class="o">[</span>ubicacion-priv-key<span class="o">]</span>
</code></pre></div>
<p>Una vez hecha la conexión SSH, podemos ver la configuración de la red que le hemos establecido a dicha máquina virtual:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>vagrant@vagrant:~$<span class="w"> </span>ip<span class="w"> </span>-brief<span class="w"> </span>-c<span class="w"> </span>a
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>lo<span class="w">               </span>UNKNOWN<span class="w">        </span><span class="m">127</span>.0.0.1/8<span class="w"> </span>::1/128<span class="w"> </span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>eth0<span class="w">             </span>UP<span class="w">             </span><span class="m">10</span>.0.2.15/24<span class="w"> </span>metric<span class="w"> </span><span class="m">100</span><span class="w"> </span>fe80::a00:27ff:fe3b:cf90/64<span class="w"> </span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>eth1<span class="w">             </span>UP<span class="w">             </span><span class="m">192</span>.168.102.102/24<span class="w"> </span>fe80::a00:27ff:fe3b:4c8d/64<span class="w"> </span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>eth2<span class="w">             </span>UP<span class="w">             </span><span class="m">192</span>.168.55.2/24<span class="w"> </span>fe80::a00:27ff:fef5:3997/64
</code></pre></div>
<p><strong>Levantamos un servicio de prueba:</strong></p>
<p>Podemos checkear el correcto funcionamiento de la IP pública y el port forwarding levantando un servicio con python en el puerto 80 de nuestra vPc:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>sudo<span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">80</span>
</code></pre></div>
<p>Y luego, podemos acceder desde el navegador de la máquina host o cualquier navegador de cualquier dispositivo que esté conectado a la misma red local:</p>
<p><img alt="Untitled" src="../source/vagrant-service-1.png" /></p>
<p><img alt="Untitled" src="../source/vagrant-service-2.png" /></p>
<h1 id="ansible">Ansible</h1>
<h2 id="aprovisionar-con-ansible-instalacion-y-conexion-del-host-con-el-servidor">Aprovisionar con Ansible - Instalación y conexión del host con el servidor</h2>
<ol>
<li>Instalamos Ansible en Ubuntu de la máquina host:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>software-properties-common
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>sudo<span class="w"> </span>apt-add-repository<span class="w"> </span>ppa:ansible/ansible
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ansible
</code></pre></div>
<ol>
<li>Nos dirigimos a la carpeta de Ansible en nuestra máquina host:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nb">cd</span><span class="w"> </span>/etc/ansible
</code></pre></div>
<ol>
<li>Veremos listados los siguientes archivos y directorios:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>ansible.cfg<span class="w">  </span>hosts<span class="w">        </span>roles/
</code></pre></div>
<p>Nos nos haremos una copia de hosts en formato .yaml en nuestra carpeta de trabajo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>sudo<span class="w"> </span>cp<span class="w"> </span>./hosts<span class="w"> </span>~/workdir/hosts.yaml
</code></pre></div>
<p>El archivo <code>hosts.yaml</code> es el <strong>inventario</strong> donde tendremos listados todos nuestros equipos que queremos controlar.</p>
<ol>
<li>Configuramos el inventario <code>hosts.yaml</code> para el ejemplo, agregando las siguientes lineas:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Example for PPS</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nt">mycluster</span><span class="p">:</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="nt">master</span><span class="p">:</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">      </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.2</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">      </span><span class="nt">ansible_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2222</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">      </span><span class="nt">ansible_ssh_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vagrant</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">      </span><span class="nt">ansible_ssh_private_key_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/aagustin/.ssh/vagrant_key</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">    </span><span class="nt">nodo1</span><span class="p">:</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">      </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.3</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">      </span><span class="nt">ansible_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2223</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="w">      </span><span class="nt">ansible_ssh_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vagrant</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">      </span><span class="nt">ansible_ssh_private_key_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/aagustin/.ssh/vagrant_key</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">    </span><span class="nt">nodo2</span><span class="p">:</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">      </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.4</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">      </span><span class="nt">ansible_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2224</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="w">      </span><span class="nt">ansible_ssh_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vagrant</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">      </span><span class="nt">ansible_ssh_private_key_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/aagustin/.ssh/vagrant_key</span>
</code></pre></div>
<p>Lo anterior es equivalente a crear un <strong>grupo</strong> de equipos (en nuestro caso es uno solo) llamado "mycluster" y dentro de ese grupo definimos los hosts llamados <strong>master, nodo1 y nodo2</strong>. Además agregamos un usuario de ssh y una ruta para la llave privada, comentados, que nos servirán luego:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>ansible<span class="w"> </span>-i<span class="w"> </span>hosts.yaml<span class="w">  </span>all<span class="w"> </span>--list-hosts
</code></pre></div>
<p>Donde el <code>-i</code> nos sirve para indicar que queremos usar un archivo en particular de inventario, que en nuestro caso es <code>hosts.yaml</code> (importante que estemos posicionados en el directorio de ansible <code>/etc/ansible</code> o que indiquemos la ruta completa del archivo de inventario). Este comando nos devolverá el siguiente mensaje:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>$<span class="w"> </span>ansible<span class="w"> </span>-i<span class="w"> </span>hosts.yaml<span class="w"> </span>all<span class="w"> </span>--list-hosts
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">  </span>hosts<span class="w"> </span><span class="o">(</span><span class="m">3</span><span class="o">)</span>:
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span>master
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">    </span>nodo1
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span>nodo2
</code></pre></div>
<p>Ahora deberemos configurar SSH para que Ansible pueda conectarse a los nodos que manejamos, en nuestro caso, a nuestra máquina virtual. Para configurar SSH y permitir conexiones SSH a sistemas remotos, debemos seguir estos pasos para agregar nuestra clave pública SSH al archivo <code>authorized_keys</code> en cada sistema remoto. En nuestro caso, ya lo hemos hecho con Vagrant:</p>
<ul>
<li><strong>Generar un par de claves SSH (si aún no lo hemos hecho)</strong>:
Si no tenemos un par de claves SSH (una pública y una privada), ppodemos generarlas usando el comando <code>ssh-keygen</code> en la terminal del host. Si deseamos utilizar la configuración predeterminada y sin contraseña, simplemente presionamos Enter cuando se nos solicite una contraseña. Aquí tienes un ejemplo:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>$<span class="w"> </span>ssh-keygen
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Generating<span class="w"> </span>public/private<span class="w"> </span>rsa<span class="w"> </span>key<span class="w"> </span>pair.
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>Enter<span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span>which<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>the<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>/home/aagustin/.ssh/id_rsa<span class="o">)</span>:<span class="w"> </span>id_rsa_ansible
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>Enter<span class="w"> </span>passphrase<span class="w"> </span><span class="o">(</span>empty<span class="w"> </span><span class="k">for</span><span class="w"> </span>no<span class="w"> </span>passphrase<span class="o">)</span>:<span class="w"> </span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>Enter<span class="w"> </span>same<span class="w"> </span>passphrase<span class="w"> </span>again:<span class="w"> </span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>Your<span class="w"> </span>identification<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span>id_rsa_ansible
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>Your<span class="w"> </span>public<span class="w"> </span>key<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span>id_rsa_ansible.pub
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>...
</code></pre></div>
<p>Esto generará un par de claves SSH en tu directorio de inicio (por defecto) en los archivos <code>id_rsa_asible</code> (clave privada) y <code>id_rsa_ansible.pub</code> (clave pública).</p>
<ul>
<li><strong>Copiar nuestra clave pública al sistema remoto</strong>:
Ahora, debes copiar nuestra clave pública (<code>id_rsa.pub</code> por defecto) al sistema remoto. Podemos hacerlo manualmente o utilizando el comando <code>ssh-copy-id</code>. Por ejemplo usando <code>ssh-copy-id</code>:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>ssh-copy-id<span class="w"> </span>usuario@nombre_del_sistema_remoto
</code></pre></div>
<p>Esto copiará nuestra clave pública al sistema remoto y la agregará al archivo <code>~/.ssh/authorized_keys</code> en ese sistema. Debemos asegurarnos de reemplazar <code>usuario</code> con nuestro nombre de usuario y <code>nombre_del_sistema_remoto</code> con la dirección IP o el nombre de host del sistema remoto.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>$<span class="w"> </span>ssh-copy-id<span class="w"> </span>vagrant@127.0.0.2
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>The<span class="w"> </span>authenticity<span class="w"> </span>of<span class="w"> </span>host<span class="w"> </span><span class="s1">&#39;127.0.0.2 (127.0.0.2)&#39;</span><span class="w"> </span>can<span class="s1">&#39;t be established.</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="s1">ED25519 key fingerprint is SHA256:xxxxxxxxxxxxxxxxxxxxx.</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="s1">This key is not known by any other names</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="s1">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="s1">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="s1">Number of key(s) added: 1</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="s1">Now try logging into the machine, with:   &quot;ssh &#39;</span>vagrant@127.0.0.2<span class="err">&#39;</span><span class="s2">&quot;</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="s2">and check to make sure that only the key(s) you wanted were added.</span>
</code></pre></div>
<ul>
<li><strong>Iniciar sesión en el sistema remoto con SSH</strong>:
Ahora, podemos iniciar sesión en el sistema remoto usando SSH y se utilizará nuestra clave pública para autenticarnos:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>ssh<span class="w"> </span>usuario@nombre_del_sistema_remoto
</code></pre></div>
<p>Si hemos configurado todo correctamente, no debería ser solicitado para ingresar una contraseña. En su lugar, se utilizará tu clave privada local para la autenticación.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="w"> </span>Welcome<span class="w"> </span>to<span class="w"> </span>Ubuntu<span class="w"> </span><span class="m">22</span>.04.3<span class="w"> </span>LTS<span class="w"> </span><span class="o">(</span>GNU/Linux<span class="w"> </span><span class="m">5</span>.15.0-83-generic<span class="w"> </span>x86_64<span class="o">)</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w"> </span>*<span class="w"> </span>Documentation:<span class="w">  </span>https://help.ubuntu.com
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w"> </span>*<span class="w"> </span>Management:<span class="w">     </span>https://landscape.canonical.com
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w"> </span>*<span class="w"> </span>Support:<span class="w">        </span>https://ubuntu.com/advantage
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">  </span>System<span class="w"> </span>information<span class="w"> </span>as<span class="w"> </span>of<span class="w"> </span>Mon<span class="w"> </span>Oct<span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">02</span>:46:20<span class="w"> </span>PM<span class="w"> </span>UTC<span class="w"> </span><span class="m">2023</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">  </span>System<span class="w"> </span>load:<span class="w">  </span><span class="m">0</span>.0<span class="w">                </span>Processes:<span class="w">             </span><span class="m">140</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">  </span>Usage<span class="w"> </span>of<span class="w"> </span>/:<span class="w">   </span><span class="m">12</span>.4%<span class="w"> </span>of<span class="w"> </span><span class="m">30</span>.34GB<span class="w">   </span>Users<span class="w"> </span>logged<span class="w"> </span><span class="k">in</span>:<span class="w">       </span><span class="m">0</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">  </span>Memory<span class="w"> </span>usage:<span class="w"> </span><span class="m">11</span>%<span class="w">                </span>IPv4<span class="w"> </span>address<span class="w"> </span><span class="k">for</span><span class="w"> </span>eth0:<span class="w"> </span><span class="m">10</span>.0.2.15
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">  </span>Swap<span class="w"> </span>usage:<span class="w">   </span><span class="m">0</span>%<span class="w">                 </span>IPv4<span class="w"> </span>address<span class="w"> </span><span class="k">for</span><span class="w"> </span>eth1:<span class="w"> </span><span class="m">192</span>.168.5.240
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>This<span class="w"> </span>system<span class="w"> </span>is<span class="w"> </span>built<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>Bento<span class="w"> </span>project<span class="w"> </span>by<span class="w"> </span>Chef<span class="w"> </span>Software
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>More<span class="w"> </span>information<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>found<span class="w"> </span>at<span class="w"> </span>https://github.com/chef/bento
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>Last<span class="w"> </span>login:<span class="w"> </span>Mon<span class="w"> </span>Oct<span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">14</span>:32:17<span class="w"> </span><span class="m">2023</span><span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.2.2
</code></pre></div>
<ul>
<li><strong>Repetir el proceso para otros sistemas remotos</strong>:
Debes repetir estos pasos para cada sistema remoto al que deseemos acceder con SSH. Copia tu clave pública al archivo <code>authorized_keys</code> en cada uno de esos sistemas.</li>
</ul>
<p>Ahora podemos corroborar la conexión con los mismos con un modulo de ansible llamado <code>ping</code>, para ello necesitamos unos pasos previos así evitamos el error con el mensaje "Permission denied (publickey,password)" que sugiere que Ansible intentó usar autenticación mediante clave pública SSH, pero no pudo autenticarse con éxito.</p>
<p><strong>Comando PING</strong>:</p>
<p>Es momento entonces de aplicar el comando de <code>ping</code> de la siguiente manera:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>ansible<span class="w"> </span>-i<span class="w"> </span>hosts.yaml<span class="w"> </span>all<span class="w"> </span>-m<span class="w"> </span>ping
</code></pre></div>
<p>Donde el <code>-m</code> indica que vamos a usar un módulo de Ansible.</p>
<p>Si todo está correcto deberá devolvernos un ping exitoso a cada una de las IP's que configuramos previamente como el siguiente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>&gt;<span class="w"> </span>ansible<span class="w"> </span>-i<span class="w"> </span>hosts.yaml<span class="w"> </span>all<span class="w"> </span>-m<span class="w"> </span>ping
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>nodo1<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">SUCCESS</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span><span class="s2">&quot;ansible_facts&quot;</span>:<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">        </span><span class="s2">&quot;discovered_interpreter_python&quot;</span>:<span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="o">}</span>,
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">    </span><span class="s2">&quot;ping&quot;</span>:<span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="o">}</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>nodo2<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">SUCCESS</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="w">    </span><span class="s2">&quot;ansible_facts&quot;</span>:<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="w">        </span><span class="s2">&quot;discovered_interpreter_python&quot;</span>:<span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="w">    </span><span class="o">}</span>,
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="w">    </span><span class="s2">&quot;ping&quot;</span>:<span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="o">}</span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>master<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">SUCCESS</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">    </span><span class="s2">&quot;ansible_facts&quot;</span>:<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">        </span><span class="s2">&quot;discovered_interpreter_python&quot;</span>:<span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">    </span><span class="o">}</span>,
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="w">    </span><span class="s2">&quot;ping&quot;</span>:<span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="o">}</span>
</code></pre></div>
<p>Podremos empezar a ejecutar comandos con Ansible, por ejemplo, para ver qué tipo de SO y qué versión tenemos instalada nos vamos a valer del siguiente comando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>ansible<span class="w"> </span>-i<span class="w"> </span>hosts.yaml<span class="w"> </span>nodo1<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;cat /etc/os-release&quot;</span>
</code></pre></div>
<p>Donde el <code>-a</code> indica que vamos a pasar argumentos al módulo.</p>
<p>Básicamente lo que hacemos es enviar ese comando al nodo1, lo que nos devolverá la lectura del archivo os-release, el cual contiene la versión del sistema.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>nodo1<span class="w"> </span><span class="p">|</span><span class="w"> </span>CHANGED<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">rc</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>&gt;&gt;
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="nv">PRETTY_NAME</span><span class="o">=</span><span class="s2">&quot;Ubuntu 22.04.3 LTS&quot;</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="nv">NAME</span><span class="o">=</span><span class="s2">&quot;Ubuntu&quot;</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="nv">VERSION_ID</span><span class="o">=</span><span class="s2">&quot;22.04&quot;</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="nv">VERSION</span><span class="o">=</span><span class="s2">&quot;22.04.3 LTS (Jammy Jellyfish)&quot;</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="nv">VERSION_CODENAME</span><span class="o">=</span>jammy
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="nv">ID</span><span class="o">=</span>ubuntu
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="nv">ID_LIKE</span><span class="o">=</span>debian
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="nv">HOME_URL</span><span class="o">=</span><span class="s2">&quot;https://www.ubuntu.com/&quot;</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="nv">SUPPORT_URL</span><span class="o">=</span><span class="s2">&quot;https://help.ubuntu.com/&quot;</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="nv">BUG_REPORT_URL</span><span class="o">=</span><span class="s2">&quot;https://bugs.launchpad.net/ubuntu/&quot;</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="nv">PRIVACY_POLICY_URL</span><span class="o">=</span><span class="s2">&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="nv">UBUNTU_CODENAME</span><span class="o">=</span>jammy
</code></pre></div>
<h3 id="aprovisionar-con-ansible-creacion-de-un-playbook">Aprovisionar con Ansible - Creación de un playbook</h3>
<p>Ahora veremos lo que es un <strong>playbook</strong>, con el cual, haremos lo mismo que hacemos con la consola de comandos pero expresado en un archivo de instrucciones. Podremos simplificar la estructura de la siguiente manera:</p>
<blockquote>
<p>PLAYBOOK &gt; PLAYS &gt; TASKS</p>
</blockquote>
<p>El playbook es un archivo en formato <code>.yml</code> o <code>.yaml</code> . El cual, en principio crearemos en la carpeta de de trabajo <code>~/workdir/ansible/</code> para hacer más corta la ruta a la hora de escribir en consola, pero podría estar en cualquier lado y la usaríamos llamando a la ruta completa.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>&gt;<span class="w"> </span>ls
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>hosts.yaml<span class="w">  </span>playbook.yaml
</code></pre></div>
<p><strong>Permisos de usuario root en caso de ser necesario (no es el nuestro):</strong></p>
<p>Antes de poder ejecutar cualquier tarea nos debemos asegurar de tener los <strong>permisos correspondientes</strong>, para ello  vamos a configurar sudo sin contraseña para el usuario Ansible para permitir que el usuario Ansible (el usuario con el que nos conectaamos) ejecute comandos sin requerir una contraseña. Esto se hace editando el archivo de configuración sudo <code>(/etc/sudoers)</code> en el host remoto y agregando una entrada que permita comandos específicos sin contraseña.</p>
<p>Agregar una entrada en <code>/etc/sudoers</code> para permitir que el usuario Ansible ejecute comandos como root sin contraseña:</p>
<ul>
<li>Accedemos por SSH a la máquina de destino:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>ssh<span class="w"> </span>vagrant@127.0.0.2
</code></pre></div>
<ul>
<li>Abrimos el archivo sudoers para edición utilizando un editor de texto en el host remoto (como visudo que garantiza que no se cometan errores de sintaxis) para abrir el archivo sudoers con privilegios de superusuario:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>sudo<span class="w"> </span>visudo
</code></pre></div>
<ul>
<li>Agregamos la entrada para el usuario de Ansible en el archivo sudoers para permitir al usuario de Ansible ejecutar comandos sin requerir una contraseña. La entrada debe tener el siguiente formato:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1"># Ansible root privileges</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>vagrant<span class="w"> </span><span class="nv">ALL</span><span class="o">=(</span>ALL:ALL<span class="o">)</span><span class="w"> </span>NOPASSWD:<span class="w"> </span>ALL
</code></pre></div>
<ul>
<li>Guardamos y cerramos.</li>
</ul>
<p>Esto permite que el usuario Ansible ejecute cualquier comando como root sin requerir una contraseña. Deberemos tener en cuenta que esta opción <strong>tiene implicaciones de seguridad</strong> y debe usarse con precaución.</p>
<p><strong>Playbook</strong></p>
<p>Continuando con el playbook, la estructura de este archivo para el ejemplo de la instalación de la biblioteca <code>nano</code> deberá ser la siguiente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nn">---</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">I want to install vim</span><span class="w"> </span><span class="c1"># Name of the play</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mycluster</span><span class="w"> </span><span class="c1">#  Name of the machine or a group of machines</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span><span class="w"> </span><span class="c1"># Adding root privileges</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sudo</span><span class="w"> </span><span class="c1"># Uses sudo to get all privileges</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="nt">become_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vagrant</span><span class="w"> </span><span class="c1"># Once you use sudo, you become root user</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="nt">tasks</span><span class="p">:</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install vagrant</span><span class="w"> </span><span class="c1"># Name of the task</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="nt">apt</span><span class="p">:</span><span class="w"> </span><span class="c1"># Name of the module</span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vim</span><span class="w"> </span><span class="c1"># Library to install</span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span><span class="w"> </span><span class="c1"># ersion of that library</span>
</code></pre></div>
<p>Para ejecutar ese archivo de instrucciones (<code>playbook.yml</code>), usamos el siguiente comando de Ansible:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>ansible-playbook<span class="w"> </span>-i<span class="w"> </span>hosts.yaml<span class="w"> </span>playbook.yaml
</code></pre></div>
<p>Lo cual nos devolverá lo siguiente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>&gt;<span class="w"> </span>ansible-playbook<span class="w"> </span>-i<span class="w"> </span>hosts.yaml<span class="w"> </span>playbook.yaml
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>PLAY<span class="w"> </span><span class="o">[</span>I<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>install<span class="w"> </span>vim<span class="o">]</span><span class="w"> </span>****************************************************************************
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>TASK<span class="w"> </span><span class="o">[</span>Gathering<span class="w"> </span>Facts<span class="o">]</span><span class="w"> </span>**********************************************************************************
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>ok:<span class="w"> </span><span class="o">[</span>master<span class="o">]</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>ok:<span class="w"> </span><span class="o">[</span>nodo2<span class="o">]</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>ok:<span class="w"> </span><span class="o">[</span>nodo1<span class="o">]</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>TASK<span class="w"> </span><span class="o">[</span>Install<span class="w"> </span>vim<span class="o">]</span><span class="w"> </span>**************************************************************************************
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>ok:<span class="w"> </span><span class="o">[</span>master<span class="o">]</span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>ok:<span class="w"> </span><span class="o">[</span>nodo2<span class="o">]</span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>ok:<span class="w"> </span><span class="o">[</span>nodo1<span class="o">]</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>**********************************************************************************************
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>master<span class="w">                     </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">2</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span><span class="w">   </span>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>nodo1<span class="w">                      </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">2</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span><span class="w">   </span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>nodo2<span class="w">                      </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">2</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span><span class="w">   </span>
</code></pre></div>
<p>Veremos que en nuestro caso, no hubo instalación de nano porque ya existia entonces, se realizaron con éxito las tareas pero <strong>no hubo cambio alguno.</strong></p>
<p>Importante que a la hora de ejecutar dichos comandos, Ansible <strong>no hará cambios</strong> si el estado deseado ya se ha logrado previamente. Por ejemplo, en este caso que queremos instalar nano suponiendo de que no estaba instalado, cuando lo ejecutemos por primera vez detectaremos que hay cambios, pero si lo ejecutamos por segunda vez veremos que habrá cero cambios ya que el estado deseado de tener instalado nano ya se ha cumplido.</p>
<p>Si el <strong>estado deseado de la tarea fuera "absent"</strong> en lugar de "latest", cuando lo corramos de nuevo, buscará que dicha librería <em>no esté</em>, nuevamente habrá un cambio y será la eliminación de dicha librería.</p>
<h1 id="kubernetes">Kubernetes</h1>
<h2 id="comparacion-de-diferentes-tecnologias">Comparación de diferentes tecnologías</h2>
<p>Deberemos explorar diferentes alternativas a la hora de ver qué nos conviene implementar, para ello se presentan las siguientes:</p>
<p><strong>Kubernetes (k8s):</strong> Kubernetes es la orquestación de contenedores más robusta y ampliamente adoptada. Es ideal para despliegues a gran escala, gestionando clústeres de contenedores con una arquitectura maestra-nodo. Ofrece una amplia gama de características y es altamente personalizable, pero su complejidad puede ser abrumadora para proyectos más pequeños.</p>
<p><strong>K3s:</strong> K3s es una versión liviana de Kubernetes diseñada para entornos con recursos limitados, como entornos de desarrollo local o dispositivos IoT. K3s simplifica la implementación y gestión de Kubernetes al reducir el número de componentes y requisitos del sistema. Esto lo hace más accesible para desarrolladores individuales y equipos que buscan una solución más ágil.</p>
<p><strong>K0s:</strong> K0s es otra alternativa ligera a Kubernetes, pero se destaca por ser un clúster autocontenido y sin dependencias externas. Esto simplifica aún más la implementación y permite ejecutar clústeres de Kubernetes sin conexión a Internet. K0s es adecuado para escenarios donde la conectividad externa puede ser limitada o poco confiable.</p>
<p><strong>Minikube:</strong> Minikube es una herramienta que facilita la ejecución de un clúster de Kubernetes de un solo nodo en entornos locales, como máquinas de desarrollo. Aunque es menos adecuado para producciones a gran escala, es una opción práctica para probar y desarrollar aplicaciones en un entorno controlado. Minikube permite a los desarrolladores experimentar con Kubernetes sin la necesidad de configuraciones complejas.</p>
<p>Por el momento centraremos nuestra atención en <strong>k8s y k0s</strong>, que a modo general podremos comparar rendimientos entre uno más completo y uno más simple, además podremos comparar la facilidad de instalación de los mismos.</p>
<h2 id="k0s-version-alternativa-y-ligera-de-k8s">k0s: Versión alternativa y ligera de K8s</h2>
<p><strong>K0s (pronunciado "k-zeros")</strong> es una plataforma Kubernetes ligera y autosuficiente diseñada para ser fácilmente desplegada en diferentes entornos, incluso aquellos con restricciones de conectividad. A diferencia de las implementaciones de Kubernetes convencionales, k0s es un clúster autónomo y no requiere de componentes externos para su funcionamiento. A continuación, se detallan sus componentes y funcionalidades clave:</p>
<ol>
<li>
<p><strong>API Server (Servidor de API):</strong> El API Server de k0s es responsable de gestionar las operaciones y comunicación en el clúster. Proporciona una interfaz para interactuar con los recursos de Kubernetes.</p>
</li>
<li>
<p><strong>Controller Manager (Administrador de Controladores):</strong> Este componente controla los controladores del sistema, que son procesos que regulan el estado del clúster y realizan acciones en respuesta a los cambios.</p>
</li>
<li>
<p><strong>Scheduler (Programador):</strong> El Scheduler se encarga de distribuir los pods en los nodos disponibles en función de las capacidades y restricciones de estos.</p>
</li>
<li>
<p><strong>etcd:</strong> K0s utiliza una versión embebida de etcd como almacenamiento de datos distribuido para mantener la coherencia del estado del clúster.</p>
</li>
<li>
<p><strong>Kubelet y Kube-proxy:</strong> Estos componentes son esenciales en cualquier implementación de Kubernetes. Kubelet es responsable de ejecutar contenedores en los nodos, mientras que Kube-proxy facilita la comunicación de red entre los diferentes servicios.</p>
</li>
<li>
<p><strong>CoreDNS:</strong> Proporciona servicios de resolución de nombres en el clúster, permitiendo la comunicación entre los servicios por nombre en lugar de direcciones IP.</p>
</li>
<li>
<p><strong>Kubelet y Kube-proxy:</strong> Estos componentes son esenciales en cualquier implementación de Kubernetes. Kubelet es responsable de ejecutar contenedores en los nodos, mientras que Kube-proxy facilita la comunicación de red entre los diferentes servicios.</p>
</li>
</ol>
<p>K0s es especialmente adecuado para entornos donde la conectividad a Internet es limitada o inestable, ya que puede operar de manera completamente autónoma. Su diseño ligero y su capacidad para funcionar como un clúster autónomo lo hacen apropiado para despliegues en dispositivos de borde (edge computing), entornos de desarrollo local y escenarios donde la simplicidad y la independencia de infraestructura externa son prioritarias. La facilidad de implementación y la capacidad de operar en entornos variados hacen que k0s sea una opción atractiva para casos de uso diversos.</p>
<p><strong>Aprovisionamiento de k0s con Ansible sobre VMs de Vagrant</strong></p>
<p>Creamos la carpeta k0s, donde aplicaremos primero el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>vagrant<span class="w"> </span>init
</code></pre></div>
<p>Dentro de la misma carpeta deberemos tener la siguiente estructura de archivos:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>k0s/
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>|_ Vagrantfle
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>|_ ansible/
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>    |_ playbook.yaml
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>    |_ inventory/
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    |    |_ inventory.yaml
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>    |_ roles/
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>        |_ .../
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>        |_ .../
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>            |_ .../
</code></pre></div>
<p>Ahora veremos que poner dentro de cada archivo.</p>
<p>En la <code>Vagrantfile</code> deberemos tener lo siguiente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c1"># -*- mode: ruby -*-</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="c1"># vi: set ft=ruby :</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="c1"># All Vagrant configuration is done below. The &quot;2&quot; in Vagrant.configure</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="c1"># configures the configuration version (we support older styles for</span>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="c1"># backwards compatibility). Please don&#39;t change it unless you know what</span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="c1"># you&#39;re doing.</span>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">config</span><span class="o">|</span>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="w">  </span><span class="c1"># Image configuration (for all vm&#39;s)</span>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bento/ubuntu-22.04&quot;</span>
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;202309.08.0&quot;</span>
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a>
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="w">  </span><span class="c1"># SSH (for all vm&#39;s)</span>
<a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">insert_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">false</span>
<a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">forward_agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">true</span><span class="w">  </span>
<a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;/home/aagustin/.vagrant.d/insecure_private_key&quot;</span><span class="p">,</span><span class="s2">&quot;/home/aagustin/.ssh/vagrant_key&quot;</span><span class="o">]</span><span class="w">     </span>
<a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a><span class="w">  </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">source</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/home/aagustin/.ssh/vagrant_key.pub&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">destination</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/home/vagrant/.ssh/authorized_keys&quot;</span>
<a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a>
<a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a><span class="w">  </span><span class="c1"># How many VMs to create</span>
<a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a><span class="w">  </span><span class="no">VMS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a>
<a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a><span class="w">  </span><span class="c1"># We need at least:</span>
<a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a><span class="w">  </span><span class="c1"># -initial_controller = must contain a single node that creates the worker and server tokens needed by the other nodes.</span>
<a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a><span class="w">  </span><span class="c1"># -controller = can contain nodes that, together with the host from initial_controller form a highly available isolated control plane.</span>
<a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a><span class="w">  </span><span class="c1"># -worker = must contain at least one node so that we can deploy Kubernetes objects.</span>
<a id="__codelineno-37-28" name="__codelineno-37-28" href="#__codelineno-37-28"></a>
<a id="__codelineno-37-29" name="__codelineno-37-29" href="#__codelineno-37-29"></a>
<a id="__codelineno-37-30" name="__codelineno-37-30" href="#__codelineno-37-30"></a><span class="w">  </span><span class="c1"># Declaring nodes (iteratively)</span>
<a id="__codelineno-37-31" name="__codelineno-37-31" href="#__codelineno-37-31"></a><span class="w">  </span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="no">VMS</span><span class="p">)</span><span class="o">.</span><span class="n">each</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">i</span><span class="o">|</span>
<a id="__codelineno-37-32" name="__codelineno-37-32" href="#__codelineno-37-32"></a><span class="w">    </span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">define</span><span class="w"> </span><span class="s2">&quot;k0s-</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">node</span><span class="o">|</span>
<a id="__codelineno-37-33" name="__codelineno-37-33" href="#__codelineno-37-33"></a>
<a id="__codelineno-37-34" name="__codelineno-37-34" href="#__codelineno-37-34"></a><span class="w">      </span><span class="c1"># Resources (provider)</span>
<a id="__codelineno-37-35" name="__codelineno-37-35" href="#__codelineno-37-35"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span><span class="w"> </span><span class="s2">&quot;virtualbox&quot;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">vb</span><span class="o">|</span>
<a id="__codelineno-37-36" name="__codelineno-37-36" href="#__codelineno-37-36"></a><span class="w">        </span><span class="n">vb</span><span class="o">.</span><span class="n">gui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">false</span>
<a id="__codelineno-37-37" name="__codelineno-37-37" href="#__codelineno-37-37"></a><span class="w">        </span><span class="n">vb</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;trusty64-k0s-</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-37-38" name="__codelineno-37-38" href="#__codelineno-37-38"></a><span class="w">        </span><span class="n">vb</span><span class="o">.</span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1024&quot;</span>
<a id="__codelineno-37-39" name="__codelineno-37-39" href="#__codelineno-37-39"></a><span class="w">        </span><span class="n">vb</span><span class="o">.</span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<a id="__codelineno-37-40" name="__codelineno-37-40" href="#__codelineno-37-40"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-37-41" name="__codelineno-37-41" href="#__codelineno-37-41"></a>
<a id="__codelineno-37-42" name="__codelineno-37-42" href="#__codelineno-37-42"></a><span class="w">      </span><span class="c1"># Configure synced folder</span>
<a id="__codelineno-37-43" name="__codelineno-37-43" href="#__codelineno-37-43"></a><span class="w">      </span><span class="c1">#config.vm.synced_folder &quot;~/my-loc/vagrant/synced/folders/k0s-#{i}/&quot;, &quot;/home/vagrant/&quot;</span>
<a id="__codelineno-37-44" name="__codelineno-37-44" href="#__codelineno-37-44"></a>
<a id="__codelineno-37-45" name="__codelineno-37-45" href="#__codelineno-37-45"></a><span class="w">      </span><span class="c1"># Network configuration</span>
<a id="__codelineno-37-46" name="__codelineno-37-46" href="#__codelineno-37-46"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;public_network&quot;</span><span class="p">,</span>
<a id="__codelineno-37-47" name="__codelineno-37-47" href="#__codelineno-37-47"></a><span class="w">        </span><span class="ss">bridge</span><span class="p">:</span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<a id="__codelineno-37-48" name="__codelineno-37-48" href="#__codelineno-37-48"></a><span class="w">        </span><span class="ss">ip</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.102.20</span><span class="si">#{</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-37-49" name="__codelineno-37-49" href="#__codelineno-37-49"></a><span class="w">        </span><span class="ss">netmask</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;255.255.255.0&quot;</span>
<a id="__codelineno-37-50" name="__codelineno-37-50" href="#__codelineno-37-50"></a>
<a id="__codelineno-37-51" name="__codelineno-37-51" href="#__codelineno-37-51"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;private_network&quot;</span><span class="p">,</span>
<a id="__codelineno-37-52" name="__codelineno-37-52" href="#__codelineno-37-52"></a><span class="w">        </span><span class="ss">ip</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.55.</span><span class="si">#{</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-37-53" name="__codelineno-37-53" href="#__codelineno-37-53"></a><span class="w">        </span><span class="ss">netmask</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;255.255.255.0&quot;</span><span class="p">,</span>
<a id="__codelineno-37-54" name="__codelineno-37-54" href="#__codelineno-37-54"></a><span class="w">        </span><span class="ss">virtualbox__intnet</span><span class="p">:</span><span class="w"> </span><span class="kp">true</span>
<a id="__codelineno-37-55" name="__codelineno-37-55" href="#__codelineno-37-55"></a><span class="w">        </span><span class="c1">#auto_config: false</span>
<a id="__codelineno-37-56" name="__codelineno-37-56" href="#__codelineno-37-56"></a>
<a id="__codelineno-37-57" name="__codelineno-37-57" href="#__codelineno-37-57"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span>
<a id="__codelineno-37-58" name="__codelineno-37-58" href="#__codelineno-37-58"></a><span class="w">        </span><span class="ss">guest</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span>
<a id="__codelineno-37-59" name="__codelineno-37-59" href="#__codelineno-37-59"></a><span class="w">        </span><span class="ss">host</span><span class="p">:</span><span class="w"> </span><span class="mi">31001</span><span class="o">+</span><span class="n">i</span>
<a id="__codelineno-37-60" name="__codelineno-37-60" href="#__codelineno-37-60"></a>
<a id="__codelineno-37-61" name="__codelineno-37-61" href="#__codelineno-37-61"></a><span class="w">      </span><span class="c1"># SSH</span>
<a id="__codelineno-37-62" name="__codelineno-37-62" href="#__codelineno-37-62"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;127.0.0.</span><span class="si">#{</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-37-63" name="__codelineno-37-63" href="#__codelineno-37-63"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">forward_agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">true</span>
<a id="__codelineno-37-64" name="__codelineno-37-64" href="#__codelineno-37-64"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span><span class="w"> </span><span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span>
<a id="__codelineno-37-65" name="__codelineno-37-65" href="#__codelineno-37-65"></a><span class="w">        </span><span class="ss">guest</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span>
<a id="__codelineno-37-66" name="__codelineno-37-66" href="#__codelineno-37-66"></a><span class="w">        </span><span class="ss">host</span><span class="p">:</span><span class="w"> </span><span class="mi">2221</span><span class="o">+</span><span class="n">i</span><span class="p">,</span>
<a id="__codelineno-37-67" name="__codelineno-37-67" href="#__codelineno-37-67"></a><span class="w">        </span><span class="ss">host_ip</span><span class="p">:</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span>
<a id="__codelineno-37-68" name="__codelineno-37-68" href="#__codelineno-37-68"></a><span class="w">        </span><span class="nb">id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ssh&quot;</span><span class="p">,</span>
<a id="__codelineno-37-69" name="__codelineno-37-69" href="#__codelineno-37-69"></a><span class="w">        </span><span class="ss">auto_correct</span><span class="p">:</span><span class="w"> </span><span class="kp">true</span>
<a id="__codelineno-37-70" name="__codelineno-37-70" href="#__codelineno-37-70"></a>
<a id="__codelineno-37-71" name="__codelineno-37-71" href="#__codelineno-37-71"></a><span class="w">      </span><span class="c1"># Provisioning message</span>
<a id="__codelineno-37-72" name="__codelineno-37-72" href="#__codelineno-37-72"></a><span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span><span class="w"> </span><span class="s2">&quot;shell&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">inline</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;echo Hello node-</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-37-73" name="__codelineno-37-73" href="#__codelineno-37-73"></a><span class="w">    </span><span class="k">end</span><span class="w">      </span>
<a id="__codelineno-37-74" name="__codelineno-37-74" href="#__codelineno-37-74"></a>
<a id="__codelineno-37-75" name="__codelineno-37-75" href="#__codelineno-37-75"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-37-76" name="__codelineno-37-76" href="#__codelineno-37-76"></a>
<a id="__codelineno-37-77" name="__codelineno-37-77" href="#__codelineno-37-77"></a><span class="k">end</span>
</code></pre></div>
<p>Ejecutaremos el comando <code>vagrant up</code> para tener las máquinas virtuales. En este caso ya supusismos que tenemos las claves privadas y públicas creadas por lo que no deberíamos tener problema. Vemos que el <code>status</code> es el siguiente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>&gt;<span class="w"> </span>vagrant<span class="w"> </span>status
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>Current<span class="w"> </span>machine<span class="w"> </span>states:
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>k0s-1<span class="w">                     </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>k0s-2<span class="w">                     </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>k0s-3<span class="w">                     </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>This<span class="w"> </span>environment<span class="w"> </span>represents<span class="w"> </span>multiple<span class="w"> </span>VMs.<span class="w"> </span>The<span class="w"> </span>VMs<span class="w"> </span>are<span class="w"> </span>all<span class="w"> </span>listed
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>above<span class="w"> </span>with<span class="w"> </span>their<span class="w"> </span>current<span class="w"> </span>state.<span class="w"> </span>For<span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>specific
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>VM,<span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>vagrant<span class="w"> </span>status<span class="w"> </span>NAME<span class="sb">`</span>.
</code></pre></div>
<p>Ahora podemos crear el inventario de Ansible <code>inventory.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="nn">---</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="nt">all</span><span class="p">:</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">  </span><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">    </span><span class="nt">initial_controller</span><span class="p">:</span>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">        </span><span class="nt">k0s-1</span><span class="p">:</span>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="w">    </span><span class="nt">controller</span><span class="p">:</span>
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="w">        </span><span class="nt">k0s-2</span><span class="p">:</span>
<a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="w">    </span><span class="nt">worker</span><span class="p">:</span>
<a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">        </span><span class="nt">k0s-3</span><span class="p">:</span>
<a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">    </span><span class="nt">k0s-1</span><span class="p">:</span>
<a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">      </span><span class="nt">ansible_ssh_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.2</span>
<a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a><span class="w">      </span><span class="nt">ansible_ssh_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2222</span>
<a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="w">    </span><span class="nt">k0s-2</span><span class="p">:</span>
<a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a><span class="w">      </span><span class="nt">ansible_ssh_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.3</span>
<a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a><span class="w">      </span><span class="nt">ansible_ssh_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2223</span>
<a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a><span class="w">    </span><span class="nt">k0s-3</span><span class="p">:</span>
<a id="__codelineno-39-21" name="__codelineno-39-21" href="#__codelineno-39-21"></a><span class="w">      </span><span class="nt">ansible_ssh_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.4</span>
<a id="__codelineno-39-22" name="__codelineno-39-22" href="#__codelineno-39-22"></a><span class="w">      </span><span class="nt">ansible_ssh_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2224</span>
<a id="__codelineno-39-23" name="__codelineno-39-23" href="#__codelineno-39-23"></a><span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
<a id="__codelineno-39-24" name="__codelineno-39-24" href="#__codelineno-39-24"></a><span class="w">    </span><span class="nt">ansible_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vagrant</span>
<a id="__codelineno-39-25" name="__codelineno-39-25" href="#__codelineno-39-25"></a><span class="w">    </span><span class="nt">ansible_private_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/home/aagustin/.ssh/vagrant_key</span>
</code></pre></div>
<p>Con el inventario creado, podemos controlar que tenemos los hosts bien configurados y hacer un ping para ver si tenemos conectividad:</p>
<ul>
<li>Listamos todos los hosts:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>&gt;<span class="w"> </span>ansible<span class="w"> </span>-i<span class="w"> </span>ansible/inventory/inventory2.yaml<span class="w"> </span>--list-hosts<span class="w"> </span>all
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">  </span>hosts<span class="w"> </span><span class="o">(</span><span class="m">3</span><span class="o">)</span>:
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">    </span>k0s-1
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">    </span>k0s-2
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w">    </span>k0s-3
</code></pre></div>
<ul>
<li>Ejecutamos el comando PING:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>&gt;<span class="w"> </span>ansible<span class="w"> </span>-i<span class="w"> </span>ansible/inventory/inventory.yaml<span class="w"> </span>-m<span class="w"> </span>ping<span class="w"> </span>all<span class="w">      </span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>k0s-1<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">SUCCESS</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">    </span><span class="s2">&quot;ansible_facts&quot;</span>:<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">        </span><span class="s2">&quot;discovered_interpreter_python&quot;</span>:<span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">    </span><span class="o">}</span>,
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="w">    </span><span class="s2">&quot;ping&quot;</span>:<span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="o">}</span>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>k0s-3<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">SUCCESS</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="w">    </span><span class="s2">&quot;ansible_facts&quot;</span>:<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="w">        </span><span class="s2">&quot;discovered_interpreter_python&quot;</span>:<span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="w">    </span><span class="o">}</span>,
<a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
<a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a><span class="w">    </span><span class="s2">&quot;ping&quot;</span>:<span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a><span class="o">}</span>
<a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a>k0s-2<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">SUCCESS</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a><span class="w">    </span><span class="s2">&quot;ansible_facts&quot;</span>:<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a><span class="w">        </span><span class="s2">&quot;discovered_interpreter_python&quot;</span>:<span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a><span class="w">    </span><span class="o">}</span>,
<a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
<a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a><span class="w">    </span><span class="s2">&quot;ping&quot;</span>:<span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a><span class="o">}</span>
</code></pre></div>
<p><em>Recordar que si es la primera vez que le damos up y no indicamos ningun fingerprint deberemos aceptar que queremos ingresar sin fingerprint poniendo <code>yes</code> en la terminal cuando nos pregunte.</em></p>
<p>Ahora nos disponemos a crear el <code>playbook.yaml</code>, con el siguiente contenido:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="nn">---</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">initial_controller:controller:worker</span>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download k0s on all nodes</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">download</span>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="w">      </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">download</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prereq</span>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">      </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prereq</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">initial_controller</span>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Configure initial k0s control plane node</span>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k0s/initial_controller</span>
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="w">      </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">init</span>
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">controller</span>
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a><span class="w">  </span><span class="nt">serial</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Configure k0s control plane nodes</span>
<a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a><span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k0s/controller</span>
<a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a><span class="w">      </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">server</span>
<a id="__codelineno-42-28" name="__codelineno-42-28" href="#__codelineno-42-28"></a>
<a id="__codelineno-42-29" name="__codelineno-42-29" href="#__codelineno-42-29"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">worker</span>
<a id="__codelineno-42-30" name="__codelineno-42-30" href="#__codelineno-42-30"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<a id="__codelineno-42-31" name="__codelineno-42-31" href="#__codelineno-42-31"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Configure k0s worker nodes</span>
<a id="__codelineno-42-32" name="__codelineno-42-32" href="#__codelineno-42-32"></a><span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<a id="__codelineno-42-33" name="__codelineno-42-33" href="#__codelineno-42-33"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">k0s/worker</span>
<a id="__codelineno-42-34" name="__codelineno-42-34" href="#__codelineno-42-34"></a><span class="w">      </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">worker</span>
</code></pre></div>
<p>Este se encargará de llamar a las diferentes plays que ejecutan ciertas tareas en los diferentes hosts. Por eso es necesario tener el contenido de la carpeta <code>roles/</code> y sus respectivos plays.</p>
<p>Una vez tenemos esto, podemos ejecutar el aprovisionamiento con Asible a los nodos creados:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>ansible-playbook<span class="w"> </span>ansible/playbook.yaml<span class="w"> </span>-i<span class="w"> </span>ansible/inventory/inventory.yaml
</code></pre></div>
<h2 id="k8s-kubernetes-convencional">K8s: Kubernetes convencional</h2>
<p><strong>Kubernetes (k8s)</strong> es una plataforma de código abierto diseñada para automatizar, escalar y operar aplicaciones en contenedores. Su arquitectura se basa en un modelo maestro-nodo que coordina la gestión de contenedores en un clúster. Aquí se describen sus principales componentes y funcionalidades:</p>
<ol>
<li>
<p><strong>API Server (Servidor de API):</strong> Actúa como la interfaz principal para la gestión y control del clúster, permitiendo la interacción con los objetos de Kubernetes, como pods, servicios y volúmenes.</p>
</li>
<li>
<p><strong>etcd:</strong> Es un almacén de datos distribuido que mantiene la configuración del clúster y el estado del mismo, garantizando la coherencia entre los nodos maestros.</p>
</li>
<li>
<p><strong>Control Plane (Plano de Control):</strong> Incluye componentes como el API Server, etcd, el Controller Manager y el Scheduler, trabajando en conjunto para tomar decisiones sobre el estado del clúster y coordinar las acciones necesarias.</p>
</li>
<li>
<p><strong>Kubelet:</strong> Este agente se ejecuta en cada nodo del clúster y es responsable de asegurar que los contenedores estén en ejecución. Interactúa con el API Server para recibir y ejecutar las instrucciones.</p>
</li>
<li>
<p><strong>Kube-proxy:</strong> Facilita la comunicación de red entre los pods y gestiona las reglas de red, como el enrutamiento y el balanceo de carga.</p>
</li>
<li>
<p><strong>Pods:</strong> La unidad más pequeña en Kubernetes, que puede contener uno o más contenedores. Los pods comparten un espacio de red y almacenamiento, lo que facilita la comunicación entre ellos.</p>
</li>
<li>
<p><strong>Services (Servicios):</strong> Proporcionan una abstracción para la comunicación entre los diferentes pods, permitiendo la escalabilidad y la resiliencia de las aplicaciones.</p>
</li>
</ol>
<p>Kubernetes es altamente versátil y puede desplegarse en una variedad de entornos, desde infraestructuras locales hasta nubes públicas. Es especialmente eficaz en entornos de producción donde la orquestación y escalabilidad de contenedores son fundamentales. Kubernetes también es utilizado comúnmente en entornos de desarrollo y pruebas para garantizar la coherencia entre los diferentes ciclos de vida de las aplicaciones. Su capacidad para gestionar cargas de trabajo en diversos entornos y su gran comunidad de usuarios lo hacen adecuado para una amplia gama de casos de uso.</p>
<h3 id="automatizacion-de-la-implementacion-de-kubernetes-k8s-en-maquinas-vagrant-utilizando-ansible">Automatización de la implementación de Kubernetes (k8s) en máquinas Vagrant utilizando Ansible</h3>
<h4 id="pasos-para-el-aprovisionamiento">Pasos para el aprovisionamiento</h4>
<ol>
<li>
<p>Cargar nuestra propia configuración de Vagrant en <code>config_vms.yaml</code></p>
</li>
<li>
<p>Detalles a tener en cuenta:</p>
<ul>
<li>Dependiendo de la cantidad de máquinas virtuales que requieras para tu laboratorio <strong>deberás cambiar</strong> la variable <code>vms</code> al número correspondiente.</li>
<li>Observar que la variable de <code>vb_memory</code> es igual a <code>2048</code> , sino habrá problemas con la ejecución de cualquier configuración de Kubernetes debido a que el requerimiento <strong>minimo de memoria son 2GB.</strong></li>
<li>Recordar que <strong>debes cambiar</strong> las variables <code>pub_key_path</code> y <code>priv_key_path</code> con los valores correspondientes a la ruta hacia tus claves pública y privada respectivamente.</li>
<li>Recordar que <strong>debes cambiar</strong> la variable <code>base_pub_ip</code> a la correspondiente a tu red LAN del laboratorio u hogar.</li>
<li>Recordar que <strong>debes cambiar</strong> la variable <code>bridged_iface</code> por la interfaz correspondiente a la que está conectada a tu red LAN del laboratorio u hogar.</li>
</ul>
<p>Deberás colocar en la variable <code>env</code> la correspondiente a tu configuración, quedando como sigue:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nn">---</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="nt">vagrant_config</span><span class="p">:</span>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;tu_usuario&#39;</span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="nt">users</span><span class="p">:</span>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">    </span><span class="nt">tu_usuario</span><span class="p">:</span>
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">      </span><span class="nt">base_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;k8s&quot;</span>
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="w">      </span><span class="nt">base_image</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bento/ubuntu-22.04&quot;</span>
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">      </span><span class="nt">base_image_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;202309.08.0&quot;</span>
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="w">      </span><span class="c1">#### -&gt; Resto de tus configuraciones</span>
</code></pre></div>
</li>
</ol>
<p>Ahora sí, podemos levantar las máquinas virtuales estando en el directorio correspondiente al archivo <code>Vagrantfile</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>vagrant<span class="w"> </span>up
</code></pre></div>
<p>Para la eliminación de las máquianas creadas usar:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>vagrant<span class="w"> </span>destroy
</code></pre></div>
<ol>
<li>Entender el directory layout de <code>ansible/</code>:</li>
</ol>
<p>Existen "buenas prácticas" a la hora de acomodar los archivos que utilizamos para aprovisionar con Ansible. Podés encontrar más información acá: <a href="https://docs.ansible.com/ansible/2.8/user_guide/playbooks_best_practices.html#DirectoryLayout">Ansible Best Practicas - Directory Layout</a></p>
<p>Luego de seguir a éste se acomodaron los directorios y archivos de la siguiente manera:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>&gt;<span class="w"> </span>tree
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>.
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>├──<span class="w"> </span>cluster_reset.yml
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>├──<span class="w"> </span>cluster_setup.yml
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>├──<span class="w"> </span>group_vars
<a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>│<span class="w">   </span>└──<span class="w"> </span>all.yml
<a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>├──<span class="w"> </span>host_vars
<a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a>├──<span class="w"> </span>inventory.yml
<a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a>├──<span class="w"> </span>old_files
<a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a>│<span class="w">   </span>├──<span class="w"> </span>ansible-get-join-command.yaml
<a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a>│<span class="w">   </span>├──<span class="w"> </span>ansible-hosts.txt
<a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>│<span class="w">   </span>├──<span class="w"> </span>ansible-init-cluster.yml
<a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a>│<span class="w">   </span>├──<span class="w"> </span>ansible-install-kubernetes-dependencies.yml
<a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a>│<span class="w">   </span>├──<span class="w"> </span>ansible-join-workers.yml
<a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a>│<span class="w">   </span>└──<span class="w"> </span>ansible-vars.yml
<a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a>├──<span class="w"> </span>reset.yml
<a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a>├──<span class="w"> </span>roles
<a id="__codelineno-47-18" name="__codelineno-47-18" href="#__codelineno-47-18"></a>│<span class="w">   </span>├──<span class="w"> </span>get_join_command
<a id="__codelineno-47-19" name="__codelineno-47-19" href="#__codelineno-47-19"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>defaults
<a id="__codelineno-47-20" name="__codelineno-47-20" href="#__codelineno-47-20"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>tasks
<a id="__codelineno-47-21" name="__codelineno-47-21" href="#__codelineno-47-21"></a>│<span class="w">   </span>│<span class="w">       </span>└──<span class="w"> </span>main.yml
<a id="__codelineno-47-22" name="__codelineno-47-22" href="#__codelineno-47-22"></a>│<span class="w">   </span>├──<span class="w"> </span>init_cluster
<a id="__codelineno-47-23" name="__codelineno-47-23" href="#__codelineno-47-23"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>defaults
<a id="__codelineno-47-24" name="__codelineno-47-24" href="#__codelineno-47-24"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>tasks
<a id="__codelineno-47-25" name="__codelineno-47-25" href="#__codelineno-47-25"></a>│<span class="w">   </span>│<span class="w">       </span>└──<span class="w"> </span>main.yml
<a id="__codelineno-47-26" name="__codelineno-47-26" href="#__codelineno-47-26"></a>│<span class="w">   </span>├──<span class="w"> </span>install_kubernetes_dependencies
<a id="__codelineno-47-27" name="__codelineno-47-27" href="#__codelineno-47-27"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>defaults
<a id="__codelineno-47-28" name="__codelineno-47-28" href="#__codelineno-47-28"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>tasks
<a id="__codelineno-47-29" name="__codelineno-47-29" href="#__codelineno-47-29"></a>│<span class="w">   </span>│<span class="w">       </span>└──<span class="w"> </span>main.yml
<a id="__codelineno-47-30" name="__codelineno-47-30" href="#__codelineno-47-30"></a>│<span class="w">   </span>├──<span class="w"> </span>join_workers
<a id="__codelineno-47-31" name="__codelineno-47-31" href="#__codelineno-47-31"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>defaults
<a id="__codelineno-47-32" name="__codelineno-47-32" href="#__codelineno-47-32"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>tasks
<a id="__codelineno-47-33" name="__codelineno-47-33" href="#__codelineno-47-33"></a>│<span class="w">   </span>│<span class="w">       </span>└──<span class="w"> </span>main.yml
<a id="__codelineno-47-34" name="__codelineno-47-34" href="#__codelineno-47-34"></a>│<span class="w">   </span>└──<span class="w"> </span>reset
<a id="__codelineno-47-35" name="__codelineno-47-35" href="#__codelineno-47-35"></a>│<span class="w">       </span>├──<span class="w"> </span>defaults
<a id="__codelineno-47-36" name="__codelineno-47-36" href="#__codelineno-47-36"></a>│<span class="w">       </span>└──<span class="w"> </span>tasks
<a id="__codelineno-47-37" name="__codelineno-47-37" href="#__codelineno-47-37"></a>│<span class="w">           </span>└──<span class="w"> </span>main.yml
<a id="__codelineno-47-38" name="__codelineno-47-38" href="#__codelineno-47-38"></a>└──<span class="w"> </span>site.yml
</code></pre></div>
<p>Cada uno de estos directorios y archivos juega un papel importante en la organización de las configuraciones y tareas de Ansible. Los elementos principales de la estructura de directorios son:</p>
<ul>
<li>
<p><code>cluster_reset.yml</code> y <code>cluster_setup.yml</code>: Son los puntos de entrada para los playbooks de Ansible. Estos archivos especifican las tareas que se deben realizar en el entorno objetivo.</p>
</li>
<li>
<p><code>group_vars/all.yml</code>: Acá se definen variables específicas de grupo que se aplicarán a todos los hosts en el inventario.</p>
</li>
<li>
<p><code>host_vars/</code>: Este directorio se utilizaría para almacenar variables específicas de host si es necesario.</p>
</li>
<li>
<p><code>inventory.yml</code>: Este archivo es donde se define nuestro inventario, es decir, la lista de hosts en los que Ansible ejecutará las tareas. Puedes definir grupos de hosts y asignar variables en este archivo.</p>
</li>
<li>
<p><code>old_files/</code>: Este directorio contiene archivos antiguos o archivos de configuración anteriores que ya no se utilizan en el proyecto, es decir, los originales previos a la reestructuración.</p>
</li>
<li>
<p><code>reset.yml</code>: Un playbook para restablecer la configuración de tu sistema o clúster.</p>
</li>
<li>
<p><code>roles/</code>: Este directorio contiene los roles de Ansible, que son módulos reutilizables que definen tareas específicas. Cada rol tiene subdirectorios para las tareas y las variables por defecto asociadas a ese rol.</p>
<ul>
<li>
<p><code>get_join_command/</code>, <code>init_cluster/</code>, <code>install_kubernetes_dependencies/</code>, <code>join_workers/</code>, y <code>reset/</code> son los nombres de los roles que estás utilizando en tu proyecto.</p>
</li>
<li>
<p>Dentro de cada rol, hay subdirectorios <code>defaults</code> y <code>tasks</code> que contienen variables por defecto y tareas específicas para ese rol.</p>
</li>
</ul>
</li>
<li>
<p><code>site.yml</code>: Es un archivo de nivel superior que suele utilizarse para orquestar la ejecución de varios playbooks y roles en un orden específico.</p>
</li>
</ul>
<p>Notarás que como extra tenemos el playbook y role para hacer un reset de las configuraciones, entonces <strong>no será necesario eliminar todas las máquinas virtuales para volver a comenzar en caso de error</strong>.</p>
<ol>
<li>
<p>Comprender lo que hace cada role en <code>roles</code>:</p>
</li>
<li>
<p><code>install_kubernetes_dependencies</code>:</p>
<ul>
<li>Instala paquetes necesarios para configurar Kubernetes y Docker, como <code>apt-transport-https</code>, <code>docker-ce</code>, <code>kubelet</code>, etc.</li>
<li>Configura claves de firma y repositorios para Docker y Kubernetes.</li>
<li>Asegura que Docker esté habilitado y en funcionamiento.</li>
<li>Deshabilita el archivo de swap y elimina las configuraciones de swap.</li>
<li>Reinicia el sistema para aplicar los cambios.</li>
</ul>
</li>
<li>
<p><code>init_cluster</code>:</p>
<ul>
<li>Configura Docker para usar el controlador de cgroups systemd.</li>
<li>Inicializa el clúster de Kubernetes con un comando <code>kubeadm init</code>, especificando una máscara de subred para la red de pod.</li>
<li>Crea un directorio <code>.kube</code> en el directorio de inicio del usuario.</li>
<li>Configura el archivo de configuración de Kubernetes en el directorio de inicio del usuario.</li>
<li>Reinicia el servicio kubelet para aplicar las configuraciones.</li>
<li>Descarga y aplica las configuraciones de red Calico y el panel de control de Kubernetes Dashboard.</li>
</ul>
</li>
<li>
<p><code>get_join_command</code>:</p>
<ul>
<li>Extrae el comando para unirse al clúster Kubernetes con el comando <code>kubeadm token create --print-join-command</code>.</li>
<li>Guarda el comando de unión en un archivo local (<code>join_command.out</code>).</li>
</ul>
</li>
<li>
<p><code>join_workers</code>:</p>
<ul>
<li>Configura Docker para usar el controlador de cgroups systemd.</li>
<li>Lee el comando de unión del archivo local.</li>
<li>Ejecuta el comando de unión para agregar nodos trabajadores al clúster.</li>
</ul>
</li>
<li>
<p><code>reset</code>:</p>
<ul>
<li>Elimina los paquetes de Kubernetes y Docker instalados previamente.</li>
<li>Elimina las claves de firma y los repositorios relacionados con Docker y Kubernetes.</li>
<li>Elimina cualquier configuración de intercambio y habilita el intercambio si estaba deshabilitado previamente.</li>
<li>Elimina la configuración del controlador de cgroups Docker.</li>
<li>Reinicia el sistema para aplicar los cambios.</li>
</ul>
</li>
<li>
<p>Modificar la variable <code>ansible_private_key: tu_ruta/tu_clave_privada</code> del archivo <code>group_vars/all.yml</code>.</p>
</li>
<li>
<p>Checkear que se hayan levantado correctamente las máquinas virtuales:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>&gt;<span class="w"> </span>vagrant<span class="w"> </span>status
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>Current<span class="w"> </span>machine<span class="w"> </span>states:
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>k8s-1<span class="w">                     </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>k8s-2<span class="w">                     </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>k8s-3<span class="w">                     </span>running<span class="w"> </span><span class="o">(</span>virtualbox<span class="o">)</span>
<a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>
<a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>This<span class="w"> </span>environment<span class="w"> </span>represents<span class="w"> </span>multiple<span class="w"> </span>VMs.<span class="w"> </span>The<span class="w"> </span>VMs<span class="w"> </span>are<span class="w"> </span>all<span class="w"> </span>listed
<a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>above<span class="w"> </span>with<span class="w"> </span>their<span class="w"> </span>current<span class="w"> </span>state.<span class="w"> </span>For<span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>specific
<a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a>VM,<span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>vagrant<span class="w"> </span>status<span class="w"> </span>NAME<span class="sb">`</span>.
</code></pre></div>
<ol>
<li><strong>¡Atención!</strong> Según tus requerimientos en cuanto a cantidad de máquinas virtuales (cual número definiste en la variable <code>vms</code> del archivo de configuración <code>config_vms.yaml</code>) deberás modificar el inventario:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="nn">---</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="nt">all</span><span class="p">:</span>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="nt">children</span><span class="p">:</span>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="w">   </span><span class="nt">kube_server</span><span class="p">:</span>
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="w">      </span><span class="nt">k8s-1</span><span class="p">:</span>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="w">         </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">foo.base_host_ip</span><span class="nv"> </span><span class="s">}}.{{</span><span class="nv"> </span><span class="s">foo.start_host_ip</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">}}&quot;</span>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="w">   </span><span class="nt">kube_agents</span><span class="p">:</span>
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="w">      </span><span class="nt">k8s-2</span><span class="p">:</span>
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="w">         </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">foo.base_host_ip</span><span class="nv"> </span><span class="s">}}.{{</span><span class="nv"> </span><span class="s">foo.start_host_ip</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">2</span><span class="nv"> </span><span class="s">}}&quot;</span>
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="w">      </span><span class="nt">k8s-3</span><span class="p">:</span>
<a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="w">         </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">foo.base_host_ip</span><span class="nv"> </span><span class="s">}}.{{</span><span class="nv"> </span><span class="s">foo.start_host_ip</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">3</span><span class="nv"> </span><span class="s">}}&quot;</span>
</code></pre></div>
<p>En nuestro caso, tenemos 3 máquinas virtuales, en el caso de haber más o menos nos aseguraremos de agregarla o eliminarla según corresponda.</p>
<ol>
<li>Comprobamos conectividad con todos los nodos:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="c1"># En el directorio /ansible</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>ansible<span class="w"> </span>-i<span class="w"> </span>inventory.yml<span class="w"> </span>-m<span class="w"> </span>ping<span class="w"> </span>all
</code></pre></div>
<p>Obtendríamos el siguiente output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="err">k</span><span class="mi">8</span><span class="err">s</span><span class="mi">-1</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">SUCCESS</span><span class="w"> </span><span class="err">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="w">   </span><span class="nt">&quot;ansible_facts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="w">      </span><span class="nt">&quot;discovered_interpreter_python&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="w">   </span><span class="p">},</span>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="w">   </span><span class="nt">&quot;changed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">   </span><span class="nt">&quot;ping&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="p">}</span>
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="err">k</span><span class="mi">8</span><span class="err">s</span><span class="mi">-2</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">SUCCESS</span><span class="w"> </span><span class="err">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="w">   </span><span class="nt">&quot;ansible_facts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="w">      </span><span class="nt">&quot;discovered_interpreter_python&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">   </span><span class="p">},</span>
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">   </span><span class="nt">&quot;changed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="w">   </span><span class="nt">&quot;ping&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="p">}</span>
<a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="err">k</span><span class="mi">8</span><span class="err">s</span><span class="mi">-3</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">SUCCESS</span><span class="w"> </span><span class="err">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="w">   </span><span class="nt">&quot;ansible_facts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a><span class="w">      </span><span class="nt">&quot;discovered_interpreter_python&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/usr/bin/python3&quot;</span>
<a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="w">   </span><span class="p">},</span>
<a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="w">   </span><span class="nt">&quot;changed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a><span class="w">   </span><span class="nt">&quot;ping&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pong&quot;</span>
<a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a><span class="p">}</span>
</code></pre></div>
<ol>
<li>Ejecutar el aprovisionamiento con Ansible:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c1"># En el directorio /ansible</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>ansible-playbook<span class="w"> </span>-vvv<span class="w"> </span>site.yml<span class="w"> </span>-i<span class="w"> </span>inventory.yml
</code></pre></div>
<p>En caso de querer resetear la configuración:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="c1"># 1) Ejecutamos el role</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>ansible-playbook<span class="w"> </span>reset.yml<span class="w"> </span>-i<span class="w"> </span>inventory.yml
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="c1"># 2) Eliminamos el archivo creado con los commands</span>
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>rm<span class="w">  </span>rm<span class="w"> </span>join_command.out<span class="w"> </span>
</code></pre></div>
<p>En caso de querer ejecutar sólo un role específico</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>ansible-playbook<span class="w"> </span>-vvv<span class="w"> </span>site.yml<span class="w"> </span>-i<span class="w"> </span>inventory.yml<span class="w"> </span>--tags<span class="w"> </span>tag_del_rol_a_ejecutar
</code></pre></div>
<ol>
<li>Checkear que todo se haya ejecutado correctamente:</li>
</ol>
<p>Primero, veremos que el output luego de ejecutar el playbook de Ansible es el siguiente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>**********************************************************************************************
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>k8s-1<span class="w">                      </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">31</span><span class="w">   </span><span class="nv">changed</span><span class="o">=</span><span class="m">21</span><span class="w">   </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span><span class="w">   </span>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>k8s-2<span class="w">                      </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">21</span><span class="w">   </span><span class="nv">changed</span><span class="o">=</span><span class="m">12</span><span class="w">   </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span><span class="w">   </span>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>k8s-3<span class="w">                      </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">21</span><span class="w">   </span><span class="nv">changed</span><span class="o">=</span><span class="m">16</span><span class="w">   </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span><span class="w">   </span>
</code></pre></div>
<p>Segundo, ingresamos por SSH a la máquina que hayamos definido como control-plane o master y nos fijaremos los nodos:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>&gt;<span class="w"> </span>ssh<span class="w"> </span>-i<span class="w"> </span>~/.ssh/vagrant_key<span class="w"> </span>vagrant@192.168.55.51
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>Welcome<span class="w"> </span>to<span class="w"> </span>Ubuntu<span class="w"> </span><span class="m">22</span>.04.3<span class="w"> </span>LTS<span class="w"> </span><span class="o">(</span>GNU/Linux<span class="w"> </span><span class="m">5</span>.15.0-83-generic<span class="w"> </span>x86_64<span class="o">)</span>
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>*<span class="w"> </span>Documentation:<span class="w">  </span>https://help.ubuntu.com
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>*<span class="w"> </span>Management:<span class="w">     </span>https://landscape.canonical.com
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>*<span class="w"> </span>Support:<span class="w">        </span>https://ubuntu.com/advantage
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>System<span class="w"> </span>information<span class="w"> </span>as<span class="w"> </span>of<span class="w"> </span>Thu<span class="w"> </span>Nov<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">05</span>:33:07<span class="w"> </span>PM<span class="w"> </span>UTC<span class="w"> </span><span class="m">2023</span>
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>System<span class="w"> </span>load:<span class="w">  </span><span class="m">1</span>.34521484375<span class="w">      </span>Users<span class="w"> </span>logged<span class="w"> </span><span class="k">in</span>:<span class="w">          </span><span class="m">0</span>
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a>Usage<span class="w"> </span>of<span class="w"> </span>/:<span class="w">   </span><span class="m">15</span>.6%<span class="w"> </span>of<span class="w"> </span><span class="m">30</span>.34GB<span class="w">   </span>IPv4<span class="w"> </span>address<span class="w"> </span><span class="k">for</span><span class="w"> </span>docker0:<span class="w"> </span><span class="m">172</span>.17.0.1
<a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a>Memory<span class="w"> </span>usage:<span class="w"> </span><span class="m">12</span>%<span class="w">                </span>IPv4<span class="w"> </span>address<span class="w"> </span><span class="k">for</span><span class="w"> </span>eth0:<span class="w">    </span><span class="m">10</span>.0.2.15
<a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a>Swap<span class="w"> </span>usage:<span class="w">   </span><span class="m">0</span>%<span class="w">                 </span>IPv4<span class="w"> </span>address<span class="w"> </span><span class="k">for</span><span class="w"> </span>eth1:<span class="w">    </span><span class="m">192</span>.168.102.51
<a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a>Processes:<span class="w">    </span><span class="m">166</span><span class="w">                </span>IPv4<span class="w"> </span>address<span class="w"> </span><span class="k">for</span><span class="w"> </span>eth2:<span class="w">    </span><span class="m">192</span>.168.55.51
<a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a>
<a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a>
<a id="__codelineno-56-17" name="__codelineno-56-17" href="#__codelineno-56-17"></a>This<span class="w"> </span>system<span class="w"> </span>is<span class="w"> </span>built<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>Bento<span class="w"> </span>project<span class="w"> </span>by<span class="w"> </span>Chef<span class="w"> </span>Software
<a id="__codelineno-56-18" name="__codelineno-56-18" href="#__codelineno-56-18"></a>More<span class="w"> </span>information<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>found<span class="w"> </span>at<span class="w"> </span>https://github.com/chef/bento
<a id="__codelineno-56-19" name="__codelineno-56-19" href="#__codelineno-56-19"></a>Last<span class="w"> </span>login:<span class="w"> </span>Thu<span class="w"> </span>Nov<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">17</span>:34:59<span class="w"> </span><span class="m">2023</span><span class="w"> </span>from<span class="w"> </span><span class="m">192</span>.168.55.1
<a id="__codelineno-56-20" name="__codelineno-56-20" href="#__codelineno-56-20"></a>
<a id="__codelineno-56-21" name="__codelineno-56-21" href="#__codelineno-56-21"></a>vagrant@k8s-1:~$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>nodes
<a id="__codelineno-56-22" name="__codelineno-56-22" href="#__codelineno-56-22"></a>NAME<span class="w">    </span>STATUS<span class="w">   </span>ROLES<span class="w">                  </span>AGE<span class="w">   </span>VERSION
<a id="__codelineno-56-23" name="__codelineno-56-23" href="#__codelineno-56-23"></a>k8s-1<span class="w">   </span>Ready<span class="w">    </span>control-plane,master<span class="w">   </span>2m<span class="w">    </span>v1.23.6
<a id="__codelineno-56-24" name="__codelineno-56-24" href="#__codelineno-56-24"></a>k8s-2<span class="w">   </span>Ready<span class="w">    </span>&lt;none&gt;<span class="w">                 </span>96s<span class="w">   </span>v1.23.6
<a id="__codelineno-56-25" name="__codelineno-56-25" href="#__codelineno-56-25"></a>k8s-3<span class="w">   </span>Ready<span class="w">    </span>&lt;none&gt;<span class="w">                 </span>96s<span class="w">   </span>v1.23.6
</code></pre></div>
<p><strong>¡Listo!</strong> Tenemos nuestro pequeño cluster de Kubernetes levantado en nuestro entorno de laboratorio.</p>
<h1 id="instalacion-de-kubeflow">Instalación de Kubeflow</h1>
<p>Para instalar Kubeflow necesitamos:</p>
<ul>
<li><strong>Aprovisionamiento de infraestructura:</strong> Creación de los nodos con Terraform o Vagrant.</li>
<li><strong>Aprovisionamiento de Sofware:</strong> Configuración de los nodos e instalación de Kubernetes (k8s)</li>
<li><strong>Instalación manual de Kubeflow:</strong> Usando los manifests que proporcionan en su repositorio.</li>
</ul>
<h2 id="aprovisionamiento-de-infraestructura-con-terraform-o-vagrant">Aprovisionamiento de infraestructura con Terraform o Vagrant</h2>
<p>Tanto como para Vagrant como para Terraform tendremos en cuenta un archivo de configuración principal, <code>k8s/ansible/group_vars/all.yml</code>. Dentro del archivo deberemos crear el perfil para nuestra prueba, donde modificaremos diferentes parámetros. En un principio, copiaremos debajo de las existentes y dentro de los usuarios un nuevo usuario con el nombre de nuestra preferencia, quedando con la siguiente forma:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>---
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>settings:
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>env: &#39;&lt;nombre-de-nuestro-perfil&gt;&#39;
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>users:  
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>    &lt;nombre-de-nuestro-perfil&gt;:
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>        prod_test: false # Si es Vagrant, false, sino true, esto deshabilita o habilita los reinicios de las VPCs respectivamente para evitar errores.
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a>        environment: &quot;&quot; # Variables de entorno que quisieramos agregar a Kubelet
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a>
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a>        user_dir_path: /home/aagustin # Path al home del local-host
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a>        node_home_dir: /home/vagrant # Path al home del remote-host
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a>
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a>        shared_folders:
<a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a>            - host_path: ./shared_folder # Para Vagrant, indicamos un path respecto a la Vagrantfile del local-host
<a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a>            vm_path: /home/vagrant # Para Vagrant, indicamos un path donde querramos compartir con el local-host
<a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a>
<a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a>        cluster_name: Kubernetes Cluster # Para Vagrant, indica el nombre del grupo de VPC&#39;s que se va a crear (es visualizable abriendo VirtualBox)
<a id="__codelineno-57-18" name="__codelineno-57-18" href="#__codelineno-57-18"></a>
<a id="__codelineno-57-19" name="__codelineno-57-19" href="#__codelineno-57-19"></a>        ssh:
<a id="__codelineno-57-20" name="__codelineno-57-20" href="#__codelineno-57-20"></a>            user: &quot;vagrant&quot; # Usuario de SSH configurado en el remote-host
<a id="__codelineno-57-21" name="__codelineno-57-21" href="#__codelineno-57-21"></a>            password: &quot;vagrant&quot; # Clave de SSH configurada en el remote-host
<a id="__codelineno-57-22" name="__codelineno-57-22" href="#__codelineno-57-22"></a>            private_key_path: /home/aagustin/.ssh/vagrant_key # Path a la clave SSH privada guardada en el local-host
<a id="__codelineno-57-23" name="__codelineno-57-23" href="#__codelineno-57-23"></a>            public_key_path: /home/aagustin/.ssh/vagrant_key.pub # Path a la clave SSH pública guardada en el local-host
<a id="__codelineno-57-24" name="__codelineno-57-24" href="#__codelineno-57-24"></a>
<a id="__codelineno-57-25" name="__codelineno-57-25" href="#__codelineno-57-25"></a>        nodes:
<a id="__codelineno-57-26" name="__codelineno-57-26" href="#__codelineno-57-26"></a>            control:
<a id="__codelineno-57-27" name="__codelineno-57-27" href="#__codelineno-57-27"></a>                cpu: 4 # Para Vagrant, cores asignados al master
<a id="__codelineno-57-28" name="__codelineno-57-28" href="#__codelineno-57-28"></a>                memory: 4096 # Para Vagrant, memoria asignada al master
<a id="__codelineno-57-29" name="__codelineno-57-29" href="#__codelineno-57-29"></a>            workers:
<a id="__codelineno-57-30" name="__codelineno-57-30" href="#__codelineno-57-30"></a>                count: 2 # Configurar cantidad de Workers
<a id="__codelineno-57-31" name="__codelineno-57-31" href="#__codelineno-57-31"></a>                cpu: 2 # Para Vagrant, cores asignados a los workers
<a id="__codelineno-57-32" name="__codelineno-57-32" href="#__codelineno-57-32"></a>                memory: 4096 # Para Vagrant, memoria asignada a los workers
<a id="__codelineno-57-33" name="__codelineno-57-33" href="#__codelineno-57-33"></a>
<a id="__codelineno-57-34" name="__codelineno-57-34" href="#__codelineno-57-34"></a>        network:
<a id="__codelineno-57-35" name="__codelineno-57-35" href="#__codelineno-57-35"></a>            control_ip: 192.168.100.171 # Configuración de la IP del nodo master
<a id="__codelineno-57-36" name="__codelineno-57-36" href="#__codelineno-57-36"></a>            dns_servers:
<a id="__codelineno-57-37" name="__codelineno-57-37" href="#__codelineno-57-37"></a>                - 8.8.8.8 # DNS de Google, para acceso a Internet
<a id="__codelineno-57-38" name="__codelineno-57-38" href="#__codelineno-57-38"></a>                - 1.1.1.1 # DNS de Cloudflare, para acceso a Internet
<a id="__codelineno-57-39" name="__codelineno-57-39" href="#__codelineno-57-39"></a>            pod_cidr: 172.16.1.0/16 # No tocar, pool de IP para los pods
<a id="__codelineno-57-40" name="__codelineno-57-40" href="#__codelineno-57-40"></a>            service_cidr: 172.17.1.0/18 # No tocar, pool de IP para los servicios
<a id="__codelineno-57-41" name="__codelineno-57-41" href="#__codelineno-57-41"></a>
<a id="__codelineno-57-42" name="__codelineno-57-42" href="#__codelineno-57-42"></a>
<a id="__codelineno-57-43" name="__codelineno-57-43" href="#__codelineno-57-43"></a>        software:
<a id="__codelineno-57-44" name="__codelineno-57-44" href="#__codelineno-57-44"></a>            box: bento/ubuntu-22.04 # Para Vagrant, imagen a utlizar
<a id="__codelineno-57-45" name="__codelineno-57-45" href="#__codelineno-57-45"></a>            calico: 3.25.0 # Versión de Calico para configurar la red de los Pods
<a id="__codelineno-57-46" name="__codelineno-57-46" href="#__codelineno-57-46"></a>            kubernetes: 1.26.1-00 # Versión de Kubernetes para instalarlo y configurar CRI-O
<a id="__codelineno-57-47" name="__codelineno-57-47" href="#__codelineno-57-47"></a>            os: xUbuntu_22.04 # Versión del SO para configurar CRI-O
<a id="__codelineno-57-48" name="__codelineno-57-48" href="#__codelineno-57-48"></a>            kustomize: 5.0.3 # La versión de Kustomize que requiere Kubeflow 1.8
<a id="__codelineno-57-49" name="__codelineno-57-49" href="#__codelineno-57-49"></a>            kubeflow: 1.8 # La versión del repo de manifests que queremos descargar
</code></pre></div>
<blockquote>
<p><strong>¡IMPORTANTE!</strong> : Recordar seleccionar en la variable <code>env</code> nuestro usuario.</p>
</blockquote>
<h3 id="vagrant_1">Vagrant</h3>
<p>Habiendo creado nuestro perfil, deberemos tener en cuenta de modificar los siguientes parámetros para nuestra infraestructura:</p>
<ol>
<li>
<p>Deshabilitar los reinicios debido a problemas con carpetas compartidas:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>prod_test: false # Si es Vagrant, false, sino true, esto deshabilita o habilita los reinicios de las VPCs respectivamente para evitar errores.
</code></pre></div>
</li>
<li>
<p>Configuración de SSH:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>ssh:
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>    user: &quot;vagrant&quot; # Usuario de SSH configurado en el remote-host
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>    password: &quot;vagrant&quot; # Clave de SSH configurada en el remote-host
<a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>    private_key_path: /home/aagustin/.ssh/vagrant_key # Path a la clave SSH privada guardada en el local-host
<a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>    public_key_path: /home/aagustin/.ssh/vagrant_key.pub # Path a la clave SSH pública guardada en el local-host
</code></pre></div>
<blockquote>
<p><strong>¡Importante!</strong> Debimos haber creado nuestra clave SSH previamente.</p>
</blockquote>
</li>
<li>
<p>Configuración de la cantidad de recursos a asignar a los nodos y la cantidad de nodos:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>nodes:
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>    control:
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>        cpu: 4 # Para Vagrant, cores asignados al master
<a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>        memory: 4096 # Para Vagrant, memoria asignada al master
<a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>    workers:
<a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>        count: 2 # Configurar cantidad de Workers
<a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>        cpu: 2 # Para Vagrant, cores asignados a los workers
<a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>        memory: 4096 # Para Vagrant, memoria asignada a los workers
</code></pre></div>
</li>
<li>
<p>Configuración de red:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>network:
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>    control_ip: 192.168.100.171 # Configuración de la IP del nodo master
</code></pre></div>
<blockquote>
<p><strong>¡Importante!</strong> En el caso de Vagrant, no es necesario que sea una IP de la red de nuestra LAN, debido a que se creará una nueva red privada para los nodos.</p>
</blockquote>
</li>
<li>
<p>Configuración del sistema:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>software:
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>    box: bento/ubuntu-22.04 # Para Vagrant, imagen a utlizar
</code></pre></div>
</li>
</ol>
<p>Finalmente, podemos levantar nuestros nodos con la Vagrantfile:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="c1"># Posicionados en &lt;repo-dir&gt;/kubernetes/k8s/</span>
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>vagrant<span class="w"> </span>up
</code></pre></div>
<p>En el caso de necesitar destruir las máquinas virtuales:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="c1"># Posicionados en &lt;repo-dir&gt;/kubernetes/k8s/</span>
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>vagrant<span class="w"> </span>destroy
</code></pre></div>
<h3 id="terraform">Terraform</h3>
<p>En nuestro caso nos encontramos aprovisionando infraestructura utilizando como base la plataforma de virtualización Proxmox, donde tendremos disponible ciertos recursos que destinaremos a la creación de los nodos (máquinas virtuales) mediante Terraform utilizando de provider justamente a Proxmox.</p>
<p>Además de modificar el archivo de <code>k8s/ansible/group_vars/all.yml</code>, deberemos modificar nuestros archivos de <code>&lt;project-dir&gt;/terraform/</code>.</p>
<p>Comenzaremos modificando los valores de los archivos de <code>&lt;project-dir&gt;/terraform/</code>:</p>
<ol>
<li>
<p>Modificamos el archivo <code>&lt;project-dir&gt;/terraform/main.tf</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="n">terraform</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="n">required_providers</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a><span class="w">    </span><span class="n">proxmox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="w">    </span><span class="n">source</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;telmate/proxmox&quot;</span><span class="w"> </span><span class="c1"># Seleccionamos el provider de proxmox</span>
<a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="w">    </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;2.9.11&quot;</span>
<a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a><span class="p">}</span>
<a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a><span class="p">}</span>
<a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a>
<a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a><span class="n">provider</span><span class="w"> </span><span class="s2">&quot;proxmox&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a>
<a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a><span class="n">pm_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">true</span>
<a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a><span class="n">pm_api_url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://192.168.100.100:8006/api2/json&quot;</span><span class="w"> </span><span class="c1"># </span>
<a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a><span class="n">pm_api_token_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;terraformuser@pam!terraformuser_token&quot;</span><span class="w"> </span><span class="c1"># Usuario Proxmox hardcodeado</span>
<a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a><span class="n">pm_api_token_secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="w"> </span><span class="c1"># Token de proxmox hardcodeado</span>
<a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a><span class="n">pm_tls_insecure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">true</span>
<a id="__codelineno-65-17" name="__codelineno-65-17" href="#__codelineno-65-17"></a><span class="n">pm_log_levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-18" name="__codelineno-65-18" href="#__codelineno-65-18"></a><span class="w">    </span><span class="n">_default</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;debug&quot;</span>
<a id="__codelineno-65-19" name="__codelineno-65-19" href="#__codelineno-65-19"></a><span class="w">    </span><span class="n">_capturelog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-65-20" name="__codelineno-65-20" href="#__codelineno-65-20"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-65-21" name="__codelineno-65-21" href="#__codelineno-65-21"></a><span class="p">}</span>
<a id="__codelineno-65-22" name="__codelineno-65-22" href="#__codelineno-65-22"></a>
<a id="__codelineno-65-23" name="__codelineno-65-23" href="#__codelineno-65-23"></a>
<a id="__codelineno-65-24" name="__codelineno-65-24" href="#__codelineno-65-24"></a><span class="n">resource</span><span class="w"> </span><span class="s2">&quot;proxmox_vm_qemu&quot;</span><span class="w"> </span><span class="s2">&quot;vms-pps&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-25" name="__codelineno-65-25" href="#__codelineno-65-25"></a>
<a id="__codelineno-65-26" name="__codelineno-65-26" href="#__codelineno-65-26"></a><span class="n">count</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">proxmox_nodes</span><span class="p">)</span>
<a id="__codelineno-65-27" name="__codelineno-65-27" href="#__codelineno-65-27"></a><span class="nb">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;k8spps${count.index+1}&quot;</span><span class="w"> </span><span class="c1"># Modificamos el nombre de nuestras vm&#39;s</span>
<a id="__codelineno-65-28" name="__codelineno-65-28" href="#__codelineno-65-28"></a><span class="n">desc</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;k8s pps&quot;</span><span class="w"> </span><span class="c1"># Modificamos la descripción de nuestras vm&#39;s</span>
<a id="__codelineno-65-29" name="__codelineno-65-29" href="#__codelineno-65-29"></a><span class="n">vmid</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;70${count.index+1}&quot;</span><span class="w"> </span><span class="c1"># Modificamos el ID de nuestras vm&#39;s</span>
<a id="__codelineno-65-30" name="__codelineno-65-30" href="#__codelineno-65-30"></a><span class="n">target_node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">var</span><span class="o">.</span><span class="n">proxmox_nodes</span><span class="o">[</span><span class="n">count</span><span class="o">.</span><span class="n">index</span><span class="o">]</span><span class="w"> </span><span class="c1"># Creará los nodos según la lista en el archivo &#39;vars.tf&#39;</span>
<a id="__codelineno-65-31" name="__codelineno-65-31" href="#__codelineno-65-31"></a><span class="nb">clone</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">var</span><span class="o">.</span><span class="n">template_name</span>
<a id="__codelineno-65-32" name="__codelineno-65-32" href="#__codelineno-65-32"></a><span class="n">agent</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-65-33" name="__codelineno-65-33" href="#__codelineno-65-33"></a><span class="n">os_type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;cloud-init&quot;</span>
<a id="__codelineno-65-34" name="__codelineno-65-34" href="#__codelineno-65-34"></a><span class="n">cores</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="c1"># Modificamos la cantidad de núcleos de nuestras vm&#39;s</span>
<a id="__codelineno-65-35" name="__codelineno-65-35" href="#__codelineno-65-35"></a><span class="n">sockets</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-65-36" name="__codelineno-65-36" href="#__codelineno-65-36"></a><span class="n">cpu</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;host&quot;</span>
<a id="__codelineno-65-37" name="__codelineno-65-37" href="#__codelineno-65-37"></a><span class="n">memory</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">8192</span><span class="w">  </span><span class="c1"># Modificamos la cantidad de memoria de nuestras vm&#39;s</span>
<a id="__codelineno-65-38" name="__codelineno-65-38" href="#__codelineno-65-38"></a><span class="n">onboot</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="kp">true</span>
<a id="__codelineno-65-39" name="__codelineno-65-39" href="#__codelineno-65-39"></a><span class="n">scsihw</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;virtio-scsi-single&quot;</span>
<a id="__codelineno-65-40" name="__codelineno-65-40" href="#__codelineno-65-40"></a><span class="n">bootdisk</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;scsi0&quot;</span>
<a id="__codelineno-65-41" name="__codelineno-65-41" href="#__codelineno-65-41"></a>
<a id="__codelineno-65-42" name="__codelineno-65-42" href="#__codelineno-65-42"></a><span class="n">disk</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-43" name="__codelineno-65-43" href="#__codelineno-65-43"></a><span class="w">    </span><span class="n">size</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;20G&quot;</span><span class="w"> </span><span class="c1"># Modificamos la cantidad de almacenamiento de nuestras vm&#39;s</span>
<a id="__codelineno-65-44" name="__codelineno-65-44" href="#__codelineno-65-44"></a><span class="w">    </span><span class="n">type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;scsi&quot;</span>
<a id="__codelineno-65-45" name="__codelineno-65-45" href="#__codelineno-65-45"></a><span class="w">    </span><span class="n">storage</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;local-lvm&quot;</span>
<a id="__codelineno-65-46" name="__codelineno-65-46" href="#__codelineno-65-46"></a><span class="w">    </span><span class="n">iothread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-65-47" name="__codelineno-65-47" href="#__codelineno-65-47"></a><span class="p">}</span>
<a id="__codelineno-65-48" name="__codelineno-65-48" href="#__codelineno-65-48"></a>
<a id="__codelineno-65-49" name="__codelineno-65-49" href="#__codelineno-65-49"></a><span class="n">network</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-50" name="__codelineno-65-50" href="#__codelineno-65-50"></a><span class="w">    </span><span class="n">model</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;virtio&quot;</span>
<a id="__codelineno-65-51" name="__codelineno-65-51" href="#__codelineno-65-51"></a><span class="w">    </span><span class="n">bridge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;vmbr0&quot;</span>
<a id="__codelineno-65-52" name="__codelineno-65-52" href="#__codelineno-65-52"></a><span class="p">}</span>
<a id="__codelineno-65-53" name="__codelineno-65-53" href="#__codelineno-65-53"></a>
<a id="__codelineno-65-54" name="__codelineno-65-54" href="#__codelineno-65-54"></a><span class="n">lifecycle</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-65-55" name="__codelineno-65-55" href="#__codelineno-65-55"></a><span class="w">    </span><span class="n">ignore_changes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
<a id="__codelineno-65-56" name="__codelineno-65-56" href="#__codelineno-65-56"></a><span class="w">    </span><span class="n">network</span><span class="p">,</span>
<a id="__codelineno-65-57" name="__codelineno-65-57" href="#__codelineno-65-57"></a><span class="w">    </span><span class="o">]</span>
<a id="__codelineno-65-58" name="__codelineno-65-58" href="#__codelineno-65-58"></a><span class="p">}</span>
<a id="__codelineno-65-59" name="__codelineno-65-59" href="#__codelineno-65-59"></a>
<a id="__codelineno-65-60" name="__codelineno-65-60" href="#__codelineno-65-60"></a><span class="n">ipconfig0</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ip=192.168.100.17${count.index+1}/24,gw=192.168.100.1&quot;</span><span class="w"> </span><span class="c1"># Modificamos las IP&#39;s de nuestras vm&#39;s</span>
<a id="__codelineno-65-61" name="__codelineno-65-61" href="#__codelineno-65-61"></a><span class="n">nameserver</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;192.168.100.1&quot;</span><span class="w"> </span><span class="c1"># Modificamos el GW de nuestras vm&#39;s</span>
<a id="__codelineno-65-62" name="__codelineno-65-62" href="#__codelineno-65-62"></a>
<a id="__codelineno-65-63" name="__codelineno-65-63" href="#__codelineno-65-63"></a><span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>Modificamos el archivo <code>&lt;project-dir&gt;/terraform/vars.tf</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="n">variable</span><span class="w"> </span><span class="s2">&quot;ssh_key&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ssh-rsa ...&quot;</span><span class="w"> </span><span class="c1"># Copiamos nuestra clave privada SSH</span>
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="p">}</span>
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>
<a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a><span class="n">variable</span><span class="w"> </span><span class="s2">&quot;proxmox_nodes&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="n">type</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;controlador&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;nodo1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;nodo2&quot;</span><span class="o">]</span><span class="w"> </span><span class="c1"># Le damos un nombre a cada nodo y definimos la cantidad añadiendo o quitando elementos a esta lista</span>
<a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a><span class="p">}</span>
<a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a>
<a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a><span class="n">variable</span><span class="w"> </span><span class="s2">&quot;template_name&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a><span class="w">    </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ubuntu-2204-template-labredes-pass-key-sudoer-nopasswd&quot;</span><span class="w"> </span><span class="c1"># Elegimos la template a utilizar</span>
<a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a><span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>El archivo <code>&lt;project-dir&gt;/terraform/create_template.sh</code> nos permite hacer modificaciones en las mismas máquinas virtuales durante su creación, es un conjunto de comandos que nos permitirá, por ejemplo, darle permisos de super-usuario al usuario o inyectarle las claves públicas SSH a los known-host. <strong>Modificaremos este archivo en caso de que cambiemos de cluster o movamos de lugar las claves SSH, las nombremos de manera distinta o necesitemos cambiar el nombre de la carpeta del usuario.</strong> Las líneas que deberemos modificar en este caso son las siguientes:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>sudo<span class="w"> </span>virt-customize<span class="w"> </span>-a<span class="w"> </span>jammy-server-cloudimg-amd64.img<span class="w"> </span>--run-command<span class="w"> </span><span class="s1">&#39;useradd -m -s /bin/bash labredes&#39;</span><span class="w"> </span><span class="c1"># Para añadir el usuario &quot;labredes&quot;</span>
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>sudo<span class="w"> </span>virt-customize<span class="w"> </span>-a<span class="w"> </span>jammy-server-cloudimg-amd64.img<span class="w"> </span>--run-command<span class="w"> </span><span class="s1">&#39;echo &quot;labredes:labredes&quot; | chpasswd&#39;</span><span class="w"> </span><span class="c1"># Para añadirle la contraseña &quot;labredes&quot; al usuario &quot;labredes&quot;</span>
<a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>sudo<span class="w"> </span>virt-customize<span class="w"> </span>-a<span class="w"> </span>jammy-server-cloudimg-amd64.img<span class="w"> </span>--run-command<span class="w"> </span><span class="s1">&#39;usermod -aG sudo,adm labredes&#39;</span><span class="w"> </span><span class="c1"># Para darle permisos de administrador y super-usuario al usuario &quot;labredes&quot;</span>
<a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a>sudo<span class="w"> </span>virt-customize<span class="w"> </span>-a<span class="w"> </span>jammy-server-cloudimg-amd64.img<span class="w"> </span>--run-command<span class="w"> </span><span class="s1">&#39;mkdir -p /home/labredes/.ssh&#39;</span><span class="w"> </span><span class="c1"># Para crear la carperta del usuario en home y la carpeta .ssh</span>
<a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>sudo<span class="w"> </span>virt-customize<span class="w"> </span>-a<span class="w"> </span>jammy-server-cloudimg-amd64.img<span class="w"> </span>--ssh-inject<span class="w"> </span>labredes:file:/root/.ssh/id_key_labredes.pub<span class="w"> </span><span class="c1"># Para inyectar la clave pública</span>
<a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a>sudo<span class="w"> </span>virt-customize<span class="w"> </span>-a<span class="w"> </span>jammy-server-cloudimg-amd64.img<span class="w"> </span>--run-command<span class="w"> </span><span class="s1">&#39;chown -R labredes:labredes /home/labredes/.ssh&#39;</span><span class="w"> </span><span class="c1"># Para cambiar la propiedad de la carpeta home al usuario &quot;labredes&quot;</span>
<a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a>sudo<span class="w"> </span>virt-customize<span class="w"> </span>-a<span class="w"> </span>jammy-server-cloudimg-amd64.img<span class="w"> </span>--run-command<span class="w"> </span><span class="s1">&#39;echo &quot;labredes ALL=(ALL) NOPASSWD: ALL&quot; &gt;&gt; /etc/sudoers&#39;</span><span class="w"> </span><span class="c1"># Para permitir al usuario &quot;labredes&quot; ejecutar comandos sudo sin escribir &#39;sudo &lt;command&gt;&#39;</span>
</code></pre></div>
</li>
</ol>
<p>Finalmente, aplicamos los siguientes comandos de Terraform:</p>
<p>a. Para inicializar un directorio de trabajo de Terraform. Descargar y configurar los proveedores de infraestructura necesarios, así como cualquier módulo de Terraform que esté siendo utilizado. Es el primer comando que se debe ejecutar al trabajar con un nuevo proyecto de Terraform.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="c1"># Posicionados en &lt;project-dir&gt;/terraform/</span>
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>terraform<span class="w"> </span>init
</code></pre></div>
<p>b. Para crear un plan de ejecución detallado de los cambios que se aplicarán a la infraestructura. Examinar los archivos de configuración de Terraform y determinar qué recursos se crearán, modificarán o eliminarán. El plan también muestra los valores de los atributos de los recursos y cualquier cambio propuesto.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="c1"># Posicionados en &lt;project-dir&gt;/terraform/</span>
<a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>terraform<span class="w"> </span>plan
</code></pre></div>
<p>c. Para aplicar los cambios definidos en el archivo de configuración de Terraform y realizar las acciones necesarias para lograr el estado deseado de la infraestructura. Terraform leerá el plan generado por el comando terraform plan y solicitará confirmación antes de aplicar los cambios. Una vez confirmado, Terraform creará, modificará o eliminará los recursos según lo especificado.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="c1"># Posicionados en &lt;project-dir&gt;/terraform/</span>
<a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>terraform<span class="w"> </span>apply
</code></pre></div>
<p>Ahora, modificando los valores de <code>k8s/ansible/group_vars/all.yml</code>:</p>
<ol>
<li>
<p>Habilitar los reinicios de las VPCs:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>prod_test: true # Si es Vagrant, false, sino true, esto deshabilita o habilita los reinicios de las VPCs respectivamente para evitar errores.
</code></pre></div>
</li>
<li>
<p>Configuración de SSH:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>ssh:
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>    user: &quot;labredes&quot; # Usuario de SSH configurado en el remote-host
<a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>    password: &quot;labredes&quot; # Clave de SSH configurada en el remote-host
<a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a>    private_key_path: /home/aagustin/.ssh/cluster_key # Path a la clave SSH privada guardada en el local-host
<a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a>    public_key_path: /home/aagustin/.ssh/cluster_key.pub # Path a la clave SSH pública guardada en el local-host
</code></pre></div>
<blockquote>
<p><strong>¡Importante!</strong> Debimos haber creado nuestra clave SSH previamente.</p>
</blockquote>
</li>
<li>
<p>Aquí solo deberemos modificar la cantidad de nodos (sin borrar nada de lo otro):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>nodes:
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>    workers:
<a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>        count: 2 # Configurar cantidad de Workers
</code></pre></div>
</li>
<li>
<p>Configuración de red:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>network:
<a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>    control_ip: 192.168.100.171 # Configuración de la IP del nodo master
</code></pre></div>
</li>
</ol>
<h2 id="aprovisionamiento-de-software-con-ansible">Aprovisionamiento de software con Ansible</h2>
<p>Aquí simplemente modificamos, tanto como si utilizamos Vagrant o Terraform, los siguientes valores de <code>k8s/ansible/group_vars/all.yml</code>:</p>
<ol>
<li>
<p>Seleccionamos las versiones de los diferentes elementos:</p>
<p><code>yml
   software:
    calico: 3.25.0 # Versión de Calico para configurar la red de los Pods
    kubernetes: 1.26.1-00 # Versión de Kubernetes para instalarlo y configurar CRI-O
    os: xUbuntu_22.04 # Versión del SO para configurar CRI-O
    kustomize: 5.0.3 # La versión de Kustomize que requiere Kubeflow 1.8
    kubeflow: 1.8 # La versión del repo de manifests que queremos descargar</code></p>
</li>
</ol>
<p>Además deberemos modificar el inventario en ambos casos, en nuestro caso, para ser pŕacticos separamos en dos inventarios correspondientes a las prubas locales (<code>ansible/inventory_local.yml</code>) y las pruebas de laboratorio (<code>ansible/inventory_lab.yml</code>). Modificaremos el que corresponda como sigue:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>---
<a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>
<a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>all:
<a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a>  children:
<a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a>    kube_master:
<a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a>      hosts:
<a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a>        master-node-171:
<a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a>          ansible_host: &quot;{{ CONTROL_IP }}&quot;
<a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a>    kube_workers:
<a id="__codelineno-75-10" name="__codelineno-75-10" href="#__codelineno-75-10"></a>      hosts:
<a id="__codelineno-75-11" name="__codelineno-75-11" href="#__codelineno-75-11"></a>        worker-node-172:
<a id="__codelineno-75-12" name="__codelineno-75-12" href="#__codelineno-75-12"></a>            ansible_host: &quot;{{ IP_SECTIONS }}172&quot;
<a id="__codelineno-75-13" name="__codelineno-75-13" href="#__codelineno-75-13"></a>        worker-node-173:
<a id="__codelineno-75-14" name="__codelineno-75-14" href="#__codelineno-75-14"></a>            ansible_host: &quot;{{ IP_SECTIONS }}173&quot;
<a id="__codelineno-75-15" name="__codelineno-75-15" href="#__codelineno-75-15"></a>        ...
<a id="__codelineno-75-16" name="__codelineno-75-16" href="#__codelineno-75-16"></a>        ...
<a id="__codelineno-75-17" name="__codelineno-75-17" href="#__codelineno-75-17"></a>        worker-node-17N:
<a id="__codelineno-75-18" name="__codelineno-75-18" href="#__codelineno-75-18"></a>            ansible_host: &quot;{{ IP_SECTIONS }}17N&quot;
</code></pre></div>
<blockquote>
<p><strong>¡Importante!</strong> Como vemos, añadiremos tantos worker-node's como hayamos creado en la sección de infraestructura y deberemos asignar <em>manualmente</em> la IP de HOST correspondiente a cada uno.</p>
</blockquote>
<p>Comprobamos conexión con los nodos con el módulo <code>ping</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="c1"># Posicionados en &lt;repo-dir&gt;/kubernetes/k8s/</span>
<a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>ansible<span class="w"> </span>-i<span class="w"> </span>ansible/inventory_&lt;<span class="nb">local</span><span class="w"> </span>o<span class="w"> </span>lab&gt;.yml<span class="w"> </span>-m<span class="w"> </span>ping<span class="w"> </span>all
</code></pre></div>
<blockquote>
<p>Deberíamos ver PING con respuesta PONG de cada uno de los nodos que hayamos creado.</p>
</blockquote>
<p>Finalmente, para correr hacer el aprovisionamiento de Software ejecutamos el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="c1"># Posicionados en &lt;repo-dir&gt;/kubernetes/k8s/</span>
<a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>ansible-playbook<span class="w"> </span>-vvv<span class="w"> </span>ansible/site.yml<span class="w"> </span>-i<span class="w"> </span>ansible/inventory_&lt;<span class="nb">local</span><span class="w"> </span>o<span class="w"> </span>lab&gt;.yml
</code></pre></div>
<blockquote>
<p><strong>-vvv</strong>: Indica el nivel de Verbose (logs) que veremos, podríamos no usar ese parámetro si no quisiéramos demasiados logs.</p>
<p><strong>¡Importante!</strong> Debemos además seleccionar el inventario según corresponda.</p>
</blockquote>
<h2 id="instalacion-manual-de-kubeflow">Instalación manual de Kubeflow</h2>
<p>Para la instalación de Kubeflow tenemos dos métodos: Paquetizado para diferentes plataformas o mediante los manifest (inistalación manual). En nuestro caso, al hacer una instalación local y limpia (bare-metal) de Kubernetes, <strong>vamos a utilizar la segunda, mediante sus manifests</strong>, los cuales se encuentran en su <a href="https://github.com/kubeflow/manifests">repositorio</a>.</p>
<p>Necesitaremos elegir la versión que nos convenga, en nuestro caso, utlizaremos la más reciente a la fecha que es la correspondiente a la branch <code>v1.8-branch</code> del correspondiente repositorio. Seleccionaremos dicha branch para observar los requerimientos.</p>
<p>Leeremos el README para poder seguir el instructivo de instalación, pero para también poder ver los pre-requisitos que nos solicita Kubeflow para su funcionamiento.</p>
<blockquote>
<p><strong>¡Importante!</strong> Trabajaremos en el directorio <code>~/</code> del nodo master, ingresaremos mediante SSH al mismo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>ssh<span class="w"> </span>-i<span class="w"> </span>~/.ssh/key<span class="w"> </span>&lt;user&gt;@&lt;IP-master&gt;
</code></pre></div>
</blockquote>
<p>Si observamos, a la fecha y para dicha versión nos pide:</p>
<p><img alt="Pre-Requisitos" src="../img/kf-prerequisites.png" /></p>
<p>El primer requisito, de la versión de Kubernetes, está cubierto debido a que hemos instalado la misma, nos falta definir una Default StorageClass.</p>
<blockquote>
<p><strong>¿Qué es una StorageClass?</strong> Las clases de almacenamiento de Kubernetes proporcionan una forma de aprovisionar dinámicamente almacenamiento persistente para aplicaciones que se ejecutan en un clúster de Kubernetes. Cada StorageClass contiene los campos provisioner, parameters y reclaimPolicy, que se utilizan cuando un PersistentVolume que pertenece a la clase debe aprovisionarse dinámicamente.</p>
<p><img alt="Kuebernetes StorageClass" src="../img/kubernetes-sc.png" /></p>
</blockquote>
<p>El segundo requisito es tener Kustomize instalado, esto nos permitirá la aplicación de las configuraciones (<code>kubectl apply ...</code>) de Kubernetes de manera automatizada.</p>
<p>Y por último, nos pide tener Kubectl, el cual está cubierto ya que se ha instalado durante el aprovisionamiento de Software.</p>
<p>Habiendo hecho el aprovisionamiento con Ansible nos habremos asegurado de tener la Local StorageClass agregada y por defecto, de tener Kustomize instalado y de tener el repositorio correspondiente a los manifests de la versión deseada ya descargado, por lo que nos queda instalar manualmente Kubeflow en nuestro Cluster. Para ello tenemos dos caminos, la instalación en un solo comando o la intalación módulo a módulo. Elegiremos la segunda por una cuestión de asegurarnos la correcta instalación paso a paso de cada uno de los módulos.</p>
<ol>
<li>
<p>Accedemos a la carpeta de los manifests:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="c1"># Posicionados en ~/</span>
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="nb">cd</span><span class="w"> </span>manifests
</code></pre></div>
<blockquote>
<p><strong>¡Importante!</strong> Se recomienda instalar comando a comando, tomando su tiempo en cada uno para checkear que se hayan levantado todos los pods, pudiendo visualizar todo esto desde el dashboard. Además, puede que algunos elementos de la instalación, como el Authservice no se inicien hasta que no hayamos levantado el siguiente, Dex en este caso. Por lo que se recomienda continuar si Eventos corresponden a errores de Webhooks. Ante la duda, podemos hacer la instalación de un solo comando que figura en el mismo repositorio.</p>
</blockquote>
</li>
<li>
<p>Instalamos el cert-manager:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/cert-manager/cert-manager/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
<a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="nv">condition</span><span class="o">=</span>ready<span class="w"> </span>pod<span class="w"> </span>-l<span class="w"> </span><span class="s1">&#39;app in (cert-manager,webhook)&#39;</span><span class="w"> </span>--timeout<span class="o">=</span>180s<span class="w"> </span>-n<span class="w"> </span>cert-manager
<a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/cert-manager/kubeflow-issuer/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
<p>Checkeamos que todos los pods estén creados y corriendo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>cert-manager
</code></pre></div>
</li>
<li>
<p>Instalamos Istio:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/istio-1-17/istio-crds/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
<a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/istio-1-17/istio-namespace/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
<a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/istio-1-17/istio-install/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
<p>Checkeamos que todos los pods estén creados y corriendo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>istio-system
</code></pre></div>
</li>
<li>
<p>Instalamos el AuthService:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/oidc-client/oidc-authservice/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
<p>Checkeamos que todos los pods estén creados y corriendo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>auth
</code></pre></div>
</li>
<li>
<p>Instalamos Dex:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/dex/overlays/istio<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
</li>
<li>
<p>Instalamos K-Native Serving</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/knative/knative-serving/overlays/gateways<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
<a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/istio-1-17/cluster-local-gateway/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
<p>Checkeamos que todos los pods estén creados y corriendo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>knative-eventing
</code></pre></div>
<p>Y también:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>knative-serving
</code></pre></div>
</li>
<li>
<p>Creamos el namespace de Kubeflow:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/kubeflow-namespace/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
</li>
<li>
<p>Instalamos los Kubeflow Roles:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/kubeflow-roles/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
<p>Checkeamos que todos los pods estén creados y corriendo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kubeflow
</code></pre></div>
</li>
<li>
<p>Creamos los recursos de Istio:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>common/istio-1-17/kubeflow-istio-resources/base<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
<p>Checkeamos que todos los pods estén creados y corriendo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>istio-system
</code></pre></div>
</li>
<li>
<p>Creamos las Pipelines de Kubeflow</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>kustomize<span class="w"> </span>build<span class="w"> </span>apps/pipeline/upstream/env/cert-manager/platform-agnostic-multi-user<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
<p>Checkeamos que todos los pods estén creados y corriendo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kubeflow
</code></pre></div>
</li>
<li>
<p>Checkeamos la creación de los pods del ejemplo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a>watch<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-n<span class="w"> </span>kubeflow-user-example-com
</code></pre></div>
</li>
</ol>
<h2 id="crear-servicio-para-exponer-el-dashboard-de-kubeflow-a-la-ip-del-nodo">Crear servicio para exponer el Dashboard de Kubeflow a la IP del nodo</h2>
<h3 id="exponer-el-servicio-port-forward-no-recomendado">Exponer el servicio (port-forward) - No recomendado</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>kubectl<span class="w"> </span>port-forward<span class="w"> </span>svc/istio-ingressgateway<span class="w"> </span>-n<span class="w"> </span>istio-system<span class="w"> </span><span class="m">8080</span>:80
</code></pre></div>
<h3 id="exponer-el-servicio-nodeport-recomendado">Exponer el servicio (NodePort) - Recomendado</h3>
<ol>
<li>
<p>Creamos el siguiente archivo para el servicio servicio <code>forwarding-svc.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-99-4" name="__codelineno-99-4" href="#__codelineno-99-4"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom-pf-svc</span>
<a id="__codelineno-99-5" name="__codelineno-99-5" href="#__codelineno-99-5"></a><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio-system</span>
<a id="__codelineno-99-6" name="__codelineno-99-6" href="#__codelineno-99-6"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-99-7" name="__codelineno-99-7" href="#__codelineno-99-7"></a><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NodePort</span>
<a id="__codelineno-99-8" name="__codelineno-99-8" href="#__codelineno-99-8"></a><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-99-9" name="__codelineno-99-9" href="#__codelineno-99-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w"> </span><span class="c1"># Where the other service is listening</span>
<a id="__codelineno-99-10" name="__codelineno-99-10" href="#__codelineno-99-10"></a><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w">  </span><span class="c1"># Where this service are available inside the cluster</span>
<a id="__codelineno-99-11" name="__codelineno-99-11" href="#__codelineno-99-11"></a><span class="w">    </span><span class="nt">nodePort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30002</span><span class="w"> </span><span class="c1"># Where to expose this service</span>
<a id="__codelineno-99-12" name="__codelineno-99-12" href="#__codelineno-99-12"></a><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-99-13" name="__codelineno-99-13" href="#__codelineno-99-13"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio-ingressgateway</span><span class="w">  </span><span class="c1"># Service to expose </span>
</code></pre></div>
</li>
<li>
<p>Aplicamos la configuración:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>forwarding-svc.yaml
</code></pre></div>
</li>
<li>
<p>Buscamos la IP (url) donde está expuesto:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="c1"># Caso de que no funcione el comando, ingresamos a la IP del nodo y al puerto configurado.</span>
<a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>service<span class="w"> </span>-n<span class="w"> </span>istio-system<span class="w"> </span>custom-pf-svc<span class="w"> </span>--url
</code></pre></div>
</li>
<li>
<p>Ingresamos a la url que nos muestra.</p>
</li>
</ol>
<h2 id="correr-ejemplo">Correr ejemplo</h2>
<p>Una vez hayamos ingresado a Kubeflow con nuestra usuario y contraseña de ejemplo: <code>user@example.com</code> y <code>12341234</code>.</p>
<blockquote>
<p><strong>¡Importante!</strong> Como vamos a trabajar sobre HTTP y no sobre HTTPS deberemos modificar la variable de entorno de <code>APP_SECURE_COOKIES</code> y setearla en <code>false</code> en cada web app que necesitemos, en nuestro caso será para Notebooks. De todas maneras no es recomendado por riesgos de seguridad. Para nuestro ejemplo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a>kubectl<span class="w"> </span>edit<span class="w"> </span>deploy<span class="w"> </span>jupyter-web-app-deployment<span class="w"> </span>-n<span class="w"> </span>kubeflow
</code></pre></div>
<p>Y este también:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a>kubectl<span class="w"> </span>edit<span class="w"> </span>deploy<span class="w"> </span>volumes-web-app-deployment<span class="w"> </span>-n<span class="w"> </span>kubeflow
</code></pre></div>
</blockquote>
<ol>
<li>
<p>Seleccionamos nuestro namespace (en nuestro caso el ejemplo que viene desplegado con la instalación)</p>
<p><img alt="Kubeflow Example 1" src="../img/kubeflow-example-1.png" /></p>
</li>
<li>
<p>Ingresar a Kubeflow en su sección "Notebooks"</p>
<p><img alt="Kubeflow Example 2" src="../img/kubeflow-example-2.png" /></p>
</li>
<li>
<p>Crear un Nuevo Notebook Server haciendo clicl en "+ New Notebook"</p>
<p><img alt="Kubeflow Example 3" src="../img/kubeflow-example-3.png" /></p>
</li>
<li>
<p>Elegimos un nombre para el Notebook Server, un entorno, el tipo de imágen, la cantidad de CPU's y RAM del mismo:</p>
<p><img alt="Kubeflow Example 4" src="../img/kubeflow-example-4.png" /></p>
</li>
<li>
<p>En nuestro caso no utilizamos GPU y crearemos un nuevo volumen para el mismo:</p>
<p><img alt="Kubeflow Example 5" src="../img/kubeflow-example-5.png" /></p>
</li>
<li>
<p>Hacemos click en "Lauch":</p>
<p><img alt="Kubeflow Example 6" src="../img/kubeflow-example-6.png" /></p>
</li>
<li>
<p>Esperamos que esté Ready y hacemos Click en "Connect"</p>
<p><img alt="Kubeflow Example 7" src="../img/kubeflow-example-7.png" /></p>
</li>
<li>
<p>Copiamos el siguiente código en el notebook:</p>
<p><a href="https://www.tensorflow.org/tutorials/keras/classification">Basic classification: Classify images of clothing</a></p>
<p><img alt="Kubeflow Example 8-a" src="../img/kubeflow-example-8-a.png" /></p>
<p><img alt="Kubeflow Example 8-b" src="../img/kubeflow-example-8-b.png" /></p>
</li>
</ol>
<blockquote>
<p><strong>¡Importante!</strong> Con <em>Ctrl + S</em> podemos guardar el notebook creado, a partir de acá nos manejamos como si tuvieramos Notebook en local. Tambien recordar instalar dependencias abriendo una consola desde le mismo Notebook Server (boton + arriba a la izquierda)</p>
</blockquote>
<h2 id="extra-instalacion-local-con-minikube">Extra: Instalación local con Minikube</h2>
<p>Si deseamos correr en local con Minikube, podemos seguir los sigueintes pasos:</p>
<h3 id="instalacion-del-binario">Instalación del binario</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span>https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
<a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a>sudo<span class="w"> </span>install<span class="w"> </span>minikube-linux-amd64<span class="w"> </span>/usr/local/bin/minikube
</code></pre></div>
<h3 id="configuracion-de-alias-para-kubectl">Configuración de alias para kubectl</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="nb">alias</span><span class="w"> </span><span class="nv">kubectl</span><span class="o">=</span><span class="s2">&quot;minikube kubectl --&quot;</span>
</code></pre></div>
<h3 id="despliegue-de-1-nodo">Despliegue de 1 nodo</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a>minikube<span class="w"> </span>start<span class="w"> </span>--kubernetes-version<span class="o">=</span><span class="s1">&#39;1.26.1&#39;</span><span class="w"> </span>--memory<span class="o">=</span><span class="s1">&#39;12288&#39;</span><span class="w"> </span>--cpus<span class="o">=</span><span class="s1">&#39;8&#39;</span><span class="w"> </span>--disk-size<span class="o">=</span><span class="s1">&#39;80GB&#39;</span><span class="w"> </span>--vm<span class="o">=</span><span class="nb">true</span>
<a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a>minikube<span class="w"> </span>addons<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>metrics-server
</code></pre></div>
<blockquote>
<p><strong>¡Importante!</strong> La cantidad de CPUs es como mínimo de 8, sino no se levantarán todos los servicios. La RAM es como mínimo de 12HB y el almacenamiento debe ser de como mínimo de 60GB.</p>
</blockquote>
<h3 id="detener-la-ejecucion-del-cluster">Detener la ejecución del Cluster</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a>minikube<span class="w"> </span>stop<span class="w"> </span>--all
</code></pre></div>
<h3 id="visualizacion">Visualización</h3>
<p>Desde otra terminal o antes de empezar podemos correr el Dashboard con el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a>minikube<span class="w"> </span>dashboard
</code></pre></div>
<h3 id="instalacion-de-kustomize">Instalación de Kustomize</h3>
<ol>
<li>
<p>Descarga de instalador</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a>wget<span class="w"> </span>https://raw.githubusercontent.com/kubernetes-sigs/kustomize/master/hack/install_kustomize.sh
</code></pre></div>
</li>
<li>
<p>Instalación de versión 5.0.3</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a>chmod<span class="w"> </span>+x<span class="w"> </span>install_kustomize.sh
<a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a>./install_kustomize.sh<span class="w"> </span><span class="m">5</span>.0.3
<a id="__codelineno-110-3" name="__codelineno-110-3" href="#__codelineno-110-3"></a>chmod<span class="w"> </span>+x<span class="w"> </span>kustomize
<a id="__codelineno-110-4" name="__codelineno-110-4" href="#__codelineno-110-4"></a>mv<span class="w"> </span>kustomize<span class="w"> </span>/usr/local/bin
</code></pre></div>
</li>
</ol>
<h3 id="descarga-de-los-manifiestos">Descarga de los manifiestos</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/kubeflow/manifests.git<span class="w"> </span>-b<span class="w"> </span>v1.8-branch
<a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a><span class="nb">cd</span><span class="w"> </span>manifests/
</code></pre></div>
<h3 id="instalacion-de-un-solo-comando-aprox-40min">Instalación de un solo comando (aprox 40min)</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kustomize<span class="w"> </span>build<span class="w"> </span>example<span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Retrying to apply resources&quot;</span><span class="p">;</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">10</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
</code></pre></div>
<h3 id="exposicion-de-servicio-dentro-del-cluster-port-forward">Exposición de servicio dentro del cluster (port-forward)</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a>kubectl<span class="w"> </span>port-forward<span class="w"> </span>svc/istio-ingressgateway<span class="w"> </span>-n<span class="w"> </span>istio-system<span class="w"> </span><span class="m">8080</span>:80
</code></pre></div>
<h3 id="exponer-fuera-del-cluster-nodeport">Exponer fuera del cluster (NodePort)</h3>
<ol>
<li>
<p>Creamos el siguiente archivo para el servicio servicio <code>forwarding-svc.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-114-2" name="__codelineno-114-2" href="#__codelineno-114-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<a id="__codelineno-114-3" name="__codelineno-114-3" href="#__codelineno-114-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-114-4" name="__codelineno-114-4" href="#__codelineno-114-4"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom-pf-svc</span>
<a id="__codelineno-114-5" name="__codelineno-114-5" href="#__codelineno-114-5"></a><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio-system</span>
<a id="__codelineno-114-6" name="__codelineno-114-6" href="#__codelineno-114-6"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-114-7" name="__codelineno-114-7" href="#__codelineno-114-7"></a><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NodePort</span>
<a id="__codelineno-114-8" name="__codelineno-114-8" href="#__codelineno-114-8"></a><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-114-9" name="__codelineno-114-9" href="#__codelineno-114-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w"> </span><span class="c1"># Where the other service is listening</span>
<a id="__codelineno-114-10" name="__codelineno-114-10" href="#__codelineno-114-10"></a><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w">  </span><span class="c1"># Where this service are available inside the cluster</span>
<a id="__codelineno-114-11" name="__codelineno-114-11" href="#__codelineno-114-11"></a><span class="w">    </span><span class="nt">nodePort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30001</span><span class="w"> </span><span class="c1"># Where to expose this service</span>
<a id="__codelineno-114-12" name="__codelineno-114-12" href="#__codelineno-114-12"></a><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-114-13" name="__codelineno-114-13" href="#__codelineno-114-13"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio-ingressgateway</span><span class="w">  </span><span class="c1"># Service to expose </span>
</code></pre></div>
</li>
<li>
<p>Aplicamos la configuración:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>forwarding-svc.yaml
</code></pre></div>
</li>
<li>
<p>Buscamos la IP (url) donde está expuesto:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a>minikube<span class="w"> </span>service<span class="w"> </span>-n<span class="w"> </span>istio-system<span class="w"> </span>custom-pf-svc<span class="w"> </span>--url
</code></pre></div>
</li>
<li>
<p>Ingresamos a la url que nos muestra.</p>
</li>
</ol>
<h3 id="configuracion-de-red">Configuración de Red</h3>
<p><img alt="Network Graph" src="../img/network-graph.png" /></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 <a href="https://www.ing.unrc.edu.ar/inicio.php"  target="_blank" rel="noopener">Universidad Nacional de Río cuarto | Facultad de Ingeniería</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/aagustinconti/pps-kubeflow" target="_blank" rel="noopener" title="Repo URL" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>